<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.5.57">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>2&nbsp; PCA – Unsupervised Machine Learning</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
/* CSS for citations */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
  margin-bottom: 0em;
}
.hanging-indent div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./03-references.html" rel="next">
<link href="./01-cluster-analysis.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

</head>

<body class="nav-sidebar floating">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./02-pca.html"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">PCA</span></a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="Search" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">Unsupervised Machine Learning</a> 
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Preface</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./01-cluster-analysis.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Cluster Analysis</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./02-pca.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">PCA</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./03-references.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">References</span></a>
  </div>
</li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#intuition-and-matrix-algebra" id="toc-intuition-and-matrix-algebra" class="nav-link active" data-scroll-target="#intuition-and-matrix-algebra"><span class="header-section-number">2.1</span> Intuition and Matrix Algebra</a></li>
  <li><a href="#case-study" id="toc-case-study" class="nav-link" data-scroll-target="#case-study"><span class="header-section-number">2.2</span> Case Study</a></li>
  <li><a href="#assumptions" id="toc-assumptions" class="nav-link" data-scroll-target="#assumptions"><span class="header-section-number">2.3</span> Assumptions</a>
  <ul>
  <li><a href="#sampling-adequacy" id="toc-sampling-adequacy" class="nav-link" data-scroll-target="#sampling-adequacy">Sampling Adequacy</a></li>
  </ul></li>
  <li><a href="#perform-pca" id="toc-perform-pca" class="nav-link" data-scroll-target="#perform-pca"><span class="header-section-number">2.4</span> Perform PCA</a></li>
  <li><a href="#appendix-eigenvectors" id="toc-appendix-eigenvectors" class="nav-link" data-scroll-target="#appendix-eigenvectors"><span class="header-section-number">2.5</span> Appendix: Eigenvectors</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<div class="quarto-title-block"><div><h1 class="title"><span id="sec-pca" class="quarto-section-identifier"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">PCA</span></span></h1><button type="button" class="btn code-tools-button dropdown-toggle" id="quarto-code-tools-menu" data-bs-toggle="dropdown" aria-expanded="false"><i class="bi"></i> Code</button><ul class="dropdown-menu dropdown-menu-end" aria-labelelledby="quarto-code-tools-menu"><li><a id="quarto-show-all-code" class="dropdown-item" href="javascript:void(0)" role="button">Show All Code</a></li><li><a id="quarto-hide-all-code" class="dropdown-item" href="javascript:void(0)" role="button">Hide All Code</a></li><li><hr class="dropdown-divider"></li><li><a id="quarto-view-source" class="dropdown-item" href="javascript:void(0)" role="button">View Source</a></li></ul></div></div>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<p>Machine learning datasets often have an enormous number of columns, many of which are correlated because they essentially measure the same latent construct. You could drop redundant columns, but sometimes the redundancy is not obvious, hidden in combinations of columns. Principle components analysis (PCA) reduces the number of columns to a few, interpretable linear combinations while retaining as much information as possible.<a href="#fn1" class="footnote-ref" id="fnref1" role="doc-noteref"><sup>1</sup></a></p>
<p>No special packages for this section, just load the tidyverse.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<section id="intuition-and-matrix-algebra" class="level2" data-number="2.1">
<h2 data-number="2.1" class="anchored" data-anchor-id="intuition-and-matrix-algebra"><span class="header-section-number">2.1</span> Intuition and Matrix Algebra</h2>
<p><span class="citation" data-cites="shlens2014tutorial">Shlens (<a href="03-references.html#ref-shlens2014tutorial" role="doc-biblioref">2014</a>)</span> introduces PCA with an intuitive toy example where the movement of an oscillating spring is monitored by cameras from three positions in a room. Each camera produces a dataset of x and y coordinates, six vectors of numbers altogether, but the physical reality is there is only one dimension of movement. PCA should be able to reduce the six vectors into a single principle component.</p>
<p>I’ll simplify this even more. The three cameras are all located at x = 0, y = 0, but are rotated 15 degrees, 45 degrees, and 150 degrees respectively. From the cameras’ perspectives, the oscillation occurs in different directions.</p>
<div class="cell">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 100 photos of the end of the spring taken over 10s of motion.</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>t <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">10</span>, <span class="at">length.out =</span> <span class="dv">100</span>)</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a><span class="co"># simple harmonic motion from our perspective: 0-degree rotation.</span></span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a>x_0 <span class="ot">&lt;-</span> <span class="fu">sin</span>(<span class="dv">2</span> <span class="sc">*</span> pi <span class="sc">*</span> <span class="fl">0.5</span> <span class="sc">*</span> t)</span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a>y_0 <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="dv">0</span>, <span class="fu">length</span>(t))</span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a>coords_0 <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">c</span>(x_0, y_0), <span class="at">ncol =</span> <span class="dv">2</span>)</span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a><span class="co"># 15-degree rotation matrix for camera 1</span></span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a>theta_1 <span class="ot">=</span> pi <span class="sc">*</span> (<span class="dv">1</span> <span class="sc">/</span> <span class="dv">12</span>)</span>
<span id="cb2-11"><a href="#cb2-11" aria-hidden="true" tabindex="-1"></a>M_1 <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">c</span>(<span class="fu">cos</span>(theta_1), <span class="sc">-</span><span class="fu">sin</span>(theta_1), <span class="fu">sin</span>(theta_1), <span class="fu">cos</span>(theta_1)), <span class="at">nrow =</span> <span class="dv">2</span>)</span>
<span id="cb2-12"><a href="#cb2-12" aria-hidden="true" tabindex="-1"></a>coords_1 <span class="ot">&lt;-</span> coords_0 <span class="sc">%*%</span> M_1</span>
<span id="cb2-13"><a href="#cb2-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-14"><a href="#cb2-14" aria-hidden="true" tabindex="-1"></a><span class="co"># 45-degree rotation matrix for camera 2</span></span>
<span id="cb2-15"><a href="#cb2-15" aria-hidden="true" tabindex="-1"></a>theta_2 <span class="ot">=</span> pi <span class="sc">*</span> (<span class="dv">1</span> <span class="sc">/</span> <span class="dv">4</span>)</span>
<span id="cb2-16"><a href="#cb2-16" aria-hidden="true" tabindex="-1"></a>M_2 <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">c</span>(<span class="fu">cos</span>(theta_2), <span class="sc">-</span><span class="fu">sin</span>(theta_2), <span class="fu">sin</span>(theta_2), <span class="fu">cos</span>(theta_2)), <span class="at">nrow =</span> <span class="dv">2</span>)</span>
<span id="cb2-17"><a href="#cb2-17" aria-hidden="true" tabindex="-1"></a>coords_2 <span class="ot">&lt;-</span> coords_0 <span class="sc">%*%</span> M_2</span>
<span id="cb2-18"><a href="#cb2-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-19"><a href="#cb2-19" aria-hidden="true" tabindex="-1"></a><span class="co"># 150-degree rotation matrix for camera 3</span></span>
<span id="cb2-20"><a href="#cb2-20" aria-hidden="true" tabindex="-1"></a>theta_3 <span class="ot">=</span> pi <span class="sc">*</span> (<span class="dv">5</span> <span class="sc">/</span> <span class="dv">6</span>)</span>
<span id="cb2-21"><a href="#cb2-21" aria-hidden="true" tabindex="-1"></a>M_3 <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">c</span>(<span class="fu">cos</span>(theta_3), <span class="sc">-</span><span class="fu">sin</span>(theta_3), <span class="fu">sin</span>(theta_3), <span class="fu">cos</span>(theta_3)), <span class="at">nrow =</span> <span class="dv">2</span>)</span>
<span id="cb2-22"><a href="#cb2-22" aria-hidden="true" tabindex="-1"></a>coords_3 <span class="ot">&lt;-</span> coords_0 <span class="sc">%*%</span> M_3</span>
<span id="cb2-23"><a href="#cb2-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-24"><a href="#cb2-24" aria-hidden="true" tabindex="-1"></a><span class="co"># Combined dataset</span></span>
<span id="cb2-25"><a href="#cb2-25" aria-hidden="true" tabindex="-1"></a>spring <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb2-26"><a href="#cb2-26" aria-hidden="true" tabindex="-1"></a>  <span class="at">camera_1_x =</span> coords_1[, <span class="dv">1</span>],</span>
<span id="cb2-27"><a href="#cb2-27" aria-hidden="true" tabindex="-1"></a>  <span class="at">camera_1_y =</span> coords_1[, <span class="dv">2</span>],</span>
<span id="cb2-28"><a href="#cb2-28" aria-hidden="true" tabindex="-1"></a>  <span class="at">camera_2_x =</span> coords_2[, <span class="dv">1</span>],</span>
<span id="cb2-29"><a href="#cb2-29" aria-hidden="true" tabindex="-1"></a>  <span class="at">camera_2_y =</span> coords_2[, <span class="dv">2</span>],</span>
<span id="cb2-30"><a href="#cb2-30" aria-hidden="true" tabindex="-1"></a>  <span class="at">camera_3_x =</span> coords_3[, <span class="dv">1</span>],</span>
<span id="cb2-31"><a href="#cb2-31" aria-hidden="true" tabindex="-1"></a>  <span class="at">camera_3_y =</span> coords_3[, <span class="dv">2</span>]</span>
<span id="cb2-32"><a href="#cb2-32" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="02-pca_files/figure-html/unnamed-chunk-3-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>pca <span class="ot">&lt;-</span> <span class="fu">prcomp</span>(spring, <span class="at">center =</span> <span class="cn">TRUE</span>, <span class="at">scale. =</span> <span class="cn">TRUE</span>)</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Summary of PCA</span></span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(pca)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Importance of components:
                         PC1       PC2       PC3       PC4       PC5      PC6
Standard deviation     2.449 2.249e-16 1.247e-16 7.428e-17 6.475e-17 3.57e-17
Proportion of Variance 1.000 0.000e+00 0.000e+00 0.000e+00 0.000e+00 0.00e+00
Cumulative Proportion  1.000 1.000e+00 1.000e+00 1.000e+00 1.000e+00 1.00e+00</code></pre>
</div>
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Biplot of PCA</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a><span class="fu">biplot</span>(pca)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="02-pca_files/figure-html/unnamed-chunk-4-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>cameras set up along three axes <span class="math inline">\(\{ \vec{a}, \vec{b}, \vec{c} \}\)</span>. That’s more dimensional data than you need! PCA reveals the hidden structure in your noisy data: <span class="math inline">\(\vec{x}\)</span> is the important dimension.</p>
<p>Your dataset consists of 72,000 rows photos: 120 photos taken per second for 10 minutes The columns are the x- and y- coordinates measured from each camera. Each row of data may be expressed as a column vector, <span class="math inline">\(\vec{X}\)</span>.</p>
<p><span class="math display">\[
\vec{X} = \begin{bmatrix} x_A \\ y_A \\ x_B \\ y_B \\ x_C \\ y_C \end{bmatrix}
\]</span></p>
<p><span class="math inline">\(\vec{X}\)</span> is an <em>m = 6</em>-dimensional vector. Equivalently, <span class="math inline">\(\vec{X}\)</span> lies in an <em>m</em>-dimensional vector space spanned by some orthonormal basis. The orthonormal basis for each camera is <span class="math inline">\(\{(1,0), (0,1)\}\)</span> <em>from its own perspective</em>, so a data point from camera <span class="math inline">\(A\)</span> might equivalently be expressed as</p>
<p><span class="math display">\[
\begin{bmatrix} 1 &amp; 0 \\ 0 &amp; 1 \end{bmatrix} \begin{bmatrix} x_A \\ y_A \end{bmatrix}
\]</span></p>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-1-contents" aria-controls="callout-1" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note on Orthonormal Bases
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-1" class="callout-1-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>An orthonormal basis is any set of vectors whose pairwise inner products are zero. The orthonormal basis for camera <span class="math inline">\(A\)</span> might be <span class="math inline">\(\{(\sqrt{2}/2,\sqrt{2}/2), (-\sqrt{2}/2,\sqrt{2}/2)\}\)</span> from a neutral perspective. From the neutral perspective, you would have to rotate the axes 45 degrees.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="co"># M is a 45-degree line</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>M <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">c</span>(<span class="dv">0</span><span class="sc">:</span><span class="dv">100</span>, <span class="dv">0</span><span class="sc">:</span><span class="dv">100</span> <span class="sc">*</span> <span class="fu">tan</span>(<span class="dv">45</span><span class="sc">*</span>(pi<span class="sc">/</span><span class="dv">180</span>))), <span class="at">ncol =</span> <span class="dv">2</span>)</span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(M) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"X"</span>, <span class="st">"Y"</span>)</span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a><span class="co"># M is unchanged after multiplication by identity matrix.</span></span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a>I <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">1</span>), <span class="at">nrow =</span> <span class="dv">2</span>)</span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a>M1 <span class="ot">&lt;-</span> M <span class="sc">%*%</span> I</span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(M1) <span class="ot">&lt;-</span> <span class="fu">colnames</span>(M)</span>
<span id="cb6-9"><a href="#cb6-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-10"><a href="#cb6-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Rotate M 45-degrees.</span></span>
<span id="cb6-11"><a href="#cb6-11" aria-hidden="true" tabindex="-1"></a>B <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">c</span>(<span class="fu">sqrt</span>(<span class="dv">2</span>)<span class="sc">/</span><span class="dv">2</span>, <span class="fu">sqrt</span>(<span class="dv">2</span>)<span class="sc">/</span><span class="dv">2</span>, <span class="sc">-</span><span class="fu">sqrt</span>(<span class="dv">2</span>)<span class="sc">/</span><span class="dv">2</span>, <span class="fu">sqrt</span>(<span class="dv">2</span>)<span class="sc">/</span><span class="dv">2</span>), <span class="at">nrow =</span> <span class="dv">2</span>)</span>
<span id="cb6-12"><a href="#cb6-12" aria-hidden="true" tabindex="-1"></a>M2 <span class="ot">&lt;-</span> M <span class="sc">%*%</span> B</span>
<span id="cb6-13"><a href="#cb6-13" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(M2) <span class="ot">&lt;-</span> <span class="fu">colnames</span>(M)</span>
<span id="cb6-14"><a href="#cb6-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-15"><a href="#cb6-15" aria-hidden="true" tabindex="-1"></a><span class="fu">bind_rows</span>(</span>
<span id="cb6-16"><a href="#cb6-16" aria-hidden="true" tabindex="-1"></a>  <span class="st">`</span><span class="at">45 degree line</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">as_tibble</span>(M1),</span>
<span id="cb6-17"><a href="#cb6-17" aria-hidden="true" tabindex="-1"></a>  <span class="st">`</span><span class="at">Rotated 45 degrees</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">as_tibble</span>(M2),</span>
<span id="cb6-18"><a href="#cb6-18" aria-hidden="true" tabindex="-1"></a>  <span class="at">.id =</span> <span class="st">"series"</span></span>
<span id="cb6-19"><a href="#cb6-19" aria-hidden="true" tabindex="-1"></a>) <span class="sc">|&gt;</span></span>
<span id="cb6-20"><a href="#cb6-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> X, <span class="at">y =</span> Y, <span class="at">color =</span> series)) <span class="sc">+</span></span>
<span id="cb6-21"><a href="#cb6-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>() <span class="sc">+</span></span>
<span id="cb6-22"><a href="#cb6-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="cn">NULL</span>, <span class="at">y =</span> <span class="cn">NULL</span>, <span class="at">color =</span> <span class="cn">NULL</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="02-pca_files/figure-html/unnamed-chunk-5-1.png" class="img-fluid figure-img" width="480"></p>
</figure>
</div>
</div>
</div>
</div>
</div>
</div>
<p>Extending this idea to the entire sample of three cameras, you might start by naively assuming the three cameras collect data from the <em>same perspective</em>, taking each measurement at face value. The set of orthonormal basis vectors, <span class="math inline">\(\textbf{B}\)</span> would look like this identity matrix</p>
<p><span class="math display">\[
\textbf{B} = \begin{bmatrix} b_1 \\ b_2 \\ \vdots \\ b_m \end{bmatrix} = \begin{bmatrix} 1 &amp; 0 &amp; \cdots &amp; 0 \\ 0 &amp; 1 &amp; \cdots &amp; 0 \\ \vdots &amp; \vdots &amp; \ddots &amp; \vdots \\ 0 &amp; 0 &amp; \cdots &amp; 1 \end{bmatrix}
\]</span></p>
<p>where <span class="math inline">\(b_1\)</span> and <span class="math inline">\(b_2\)</span> are the bases used by camera <span class="math inline">\(A\)</span>, etc. Now the data set <span class="math inline">\(\textbf{X}\)</span> can be expressed as the matrix multiplication, <span class="math inline">\(\textbf{BX}\)</span>. This added complexity allows you to ask whether another basis, <span class="math inline">\(\textbf{P}\)</span>, <em>that is a linear combination of the original basis</em>, better expresses the data set, <span class="math inline">\(\textbf{PX} = \textbf{Y}\)</span>. The <em>linear</em> restriction is a key simplifying assumption of PCA. <span class="math inline">\(\textbf{P}\)</span> transforms <span class="math inline">\(\textbf{X}\)</span> into <span class="math inline">\(\textbf{Y}\)</span>, but you can also think of it as rotating and stretching <span class="math inline">\(\textbf{X}\)</span> into <span class="math inline">\(\textbf{Y}.\)</span></p>
<p>The goal of PCA is to maximize variance (the signal-to-noise ratio) and minimize covariance (redundancy). The signal-to-noise ratio is <span class="math inline">\(SNR = \sigma^2_{signal} / \sigma^2_{noise}\)</span>. In each camera’s 2D perspective, the signal is the amplitude of the movement of the spring along the x-axis and the noise is the movement along the y-axis. Looking at the raw (un-rotated) data from camera <span class="math inline">\(A\)</span>, you might guess the spring dynamics occur in the direction yielding the highest SNR, the 45-degree rotation.</p>
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="02-pca_files/figure-html/unnamed-chunk-6-1.png" class="img-fluid figure-img" width="336"></p>
</figure>
</div>
</div>
</div>
<p>The other criteria is redundancy. There are three cameras recording the same activity, so they are perfectly correlated. If <span class="math inline">\(\textbf{X}\)</span> is an <span class="math inline">\(m \times n\)</span> matrix of centered values (subtracting the mean), PCA will find an orthonormal matrix <span class="math inline">\(\textbf{P}\)</span> in <span class="math inline">\(\textbf{Y} = \textbf{PX}\)</span> such that the covariance matrix <span class="math inline">\(\textbf{C}_\textbf{Y} = \frac{1}{n}\textbf{YY}^T\)</span> is a diagonal matrix. The rows of <span class="math inline">\(\textbf{P}\)</span> are the principal components of <span class="math inline">\(\textbf{X}\)</span>.</p>
<p>The process is to select a normalized direction in <em>m</em>-dimensional space which maximizes the <span class="math inline">\(\textbf{X}\)</span> variance. Save this vector as <span class="math inline">\(\textbf{p}_1\)</span>. Next find a second direction along which variance is maximized, but restrict the search to directions that are orthogonal to the previous direction. Save this vector as <span class="math inline">\(\textbf{p}_2\)</span>. Repeat until all <em>m</em> vectors are selected. The resulting ordered set of <span class="math inline">\(\textbf{p}\)</span>’s are the principal components.</p>
<p>With matrix algebra, you can express <span class="math inline">\(\textbf{C}_\textbf{Y}\)</span> in terms of the covariance matrix of <span class="math inline">\(\textbf{X}\)</span>, <span class="math inline">\(\textbf{C}_\textbf{X}\)</span>.</p>
<p><span class="math display">\[
\begin{align}
\textbf{C}_\textbf{Y} &amp;= \frac{1}{n}\textbf{YY}^T \\
&amp;= \frac{1}{n}(\textbf{PX})(\textbf{PX})^T \\
&amp;= \frac{1}{n}\textbf{PXX}^T\textbf{P}^T \\
&amp;= P\left(\frac{1}{n}\textbf{XX}^T\right)\textbf{P}^T \\
&amp;= \textbf{PC}_\textbf{X}\textbf{P}^T
\end{align}
\]</span></p>
<p>Any symmetric matrix can be diagonalized by an orthogonal matrix of its eigenvectors, <span class="math inline">\(\textbf{C}_\textbf{X} = \textbf{E}^T\textbf{DE}\)</span>. So select <span class="math inline">\(\textbf{P}\)</span> to be such a matrix.</p>
<p><span class="math display">\[
\begin{align}
\textbf{C}_\textbf{Y} &amp;= \textbf{PC}_\textbf{X}\textbf{P}^T \\
&amp;= \textbf{P}(\textbf{E}^T\textbf{DE})\textbf{P}^T \\
&amp;= \textbf{P}(\textbf{P}^T\textbf{DP})\textbf{P}^T \\
&amp;= (\textbf{PP}^T)\textbf{D}(\textbf{PP}^T) \\
&amp;= (\textbf{PP}^{-1})\textbf{D}(\textbf{PP}^{-1}) \\
&amp;= \textbf{D}
\end{align}
\]</span></p>
</section>
<section id="case-study" class="level2" data-number="2.2">
<h2 data-number="2.2" class="anchored" data-anchor-id="case-study"><span class="header-section-number">2.2</span> Case Study</h2>
<p>Let’s work with a case study presented by <a href="https://statistics.laerd.com/premium/spss/pca/pca-in-spss.php">Laerd</a>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>pca_dat <span class="ot">&lt;-</span> </span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>  foreign<span class="sc">::</span><span class="fu">read.spss</span>(<span class="st">"./input/pca.sav"</span>, <span class="at">to.data.frame =</span> <span class="cn">TRUE</span>) <span class="sc">|&gt;</span></span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">across</span>(<span class="fu">where</span>(is.factor), <span class="sc">~</span><span class="fu">factor</span>(., <span class="at">levels =</span> likert_scale, <span class="at">ordered =</span> <span class="cn">TRUE</span>))</span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a><span class="fu">glimpse</span>(pca_dat)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Rows: 315
Columns: 30
$ Qu1    &lt;ord&gt; Agree Somewhat, Disagree, Disagree Somewhat, Undecided, Undecid…
$ Qu2    &lt;ord&gt; Undecided, Strongly Agree, Agree, Disagree, Disagree, Disagree,…
$ Qu3    &lt;ord&gt; Undecided, Agree, Agree Somewhat, Agree, Agree, Agree Somewhat,…
$ Qu4    &lt;ord&gt; Undecided, Agree, Agree, Disagree, Disagree, Agree Somewhat, Ag…
$ Qu5    &lt;ord&gt; Undecided, Agree, Agree Somewhat, Disagree Somewhat, Disagree S…
$ Qu6    &lt;ord&gt; Undecided, Agree Somewhat, Agree Somewhat, Disagree, Disagree, …
$ Qu7    &lt;ord&gt; Undecided, Agree Somewhat, Agree, Disagree Somewhat, Disagree S…
$ Qu8    &lt;ord&gt; Undecided, Agree Somewhat, Agree Somewhat, Disagree, Disagree, …
$ Qu9    &lt;ord&gt; Agree Somewhat, Agree Somewhat, Disagree Somewhat, Undecided, U…
$ Qu10   &lt;ord&gt; Undecided, Agree Somewhat, Disagree Somewhat, Disagree, Disagre…
$ Qu11   &lt;ord&gt; Agree Somewhat, Agree Somewhat, Disagree Somewhat, Agree Somewh…
$ Qu12   &lt;ord&gt; Strongly Agree, Agree, Agree, Agree, Agree, Agree, Agree, Agree…
$ Qu13   &lt;ord&gt; Undecided, Agree, Agree, Strongly Agree, Strongly Agree, Agree,…
$ Qu14   &lt;ord&gt; Undecided, Agree, Agree Somewhat, Agree Somewhat, Agree Somewha…
$ Qu15   &lt;ord&gt; Undecided, Agree, Agree, Agree Somewhat, Agree Somewhat, Agree …
$ Qu16   &lt;ord&gt; Undecided, Agree, Agree Somewhat, Undecided, Undecided, Disagre…
$ Qu17   &lt;ord&gt; Undecided, Agree, Agree Somewhat, Undecided, Undecided, Agree S…
$ Qu18   &lt;ord&gt; Undecided, Agree Somewhat, Agree, Agree Somewhat, Agree Somewha…
$ Qu19   &lt;ord&gt; Agree Somewhat, Strongly Agree, Agree, Disagree, Disagree, Disa…
$ Qu20   &lt;ord&gt; Undecided, Agree, Agree Somewhat, Disagree Somewhat, Disagree S…
$ Qu21   &lt;ord&gt; Undecided, Strongly Agree, Agree Somewhat, Agree, Agree, Strong…
$ Qu22   &lt;ord&gt; Undecided, Agree Somewhat, Agree Somewhat, Agree Somewhat, Agre…
$ Qu23   &lt;ord&gt; Undecided, Strongly Agree, Agree Somewhat, Agree Somewhat, Agre…
$ Qu24   &lt;ord&gt; Undecided, Agree, Agree Somewhat, Agree, Agree, Agree, Undecide…
$ Qu25   &lt;ord&gt; Undecided, Strongly Agree, Agree Somewhat, Agree Somewhat, Agre…
$ FAC1_1 &lt;dbl&gt; -0.31985907, -1.85802269, -1.36495416, 0.02235922, 0.02235922, …
$ FAC2_1 &lt;dbl&gt; -0.6366505, -1.5727256, -1.6357254, -0.6846857, -0.6846857, -1.…
$ FAC3_1 &lt;dbl&gt; 0.825818943, -1.576466472, -0.125140607, -0.576649155, -0.57664…
$ FAC4_1 &lt;dbl&gt; -1.4492270, -0.9594769, 0.3063403, -0.3991595, -0.3991595, 1.60…
$ FAC5_1 &lt;dbl&gt; -0.03960671, -0.03584510, -0.80707018, 1.59287496, 1.59287496, …</code></pre>
</div>
</div>
<p>315 job candidates complete a questionnaire consisting of 25 questions using a 7-level Likert scale. Questions focused on motivation, dependability, enthusiasm, and commitment.</p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-1-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-1" role="tab" aria-controls="tabset-1-1" aria-selected="true">Motivaton</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-1-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-2" role="tab" aria-controls="tabset-1-2" aria-selected="false">Dependability</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-1-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-3" role="tab" aria-controls="tabset-1-3" aria-selected="false">Enthusiasm</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-1-4-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-4" role="tab" aria-controls="tabset-1-4" aria-selected="false">Commitment</a></li></ul>
<div class="tab-content">
<div id="tabset-1-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-1-1-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="fu">gt_items</span>(<span class="fu">c</span>(<span class="st">"Qu3"</span>, <span class="st">"Qu4"</span>, <span class="st">"Qu5"</span>, <span class="st">"Qu6"</span>, <span class="st">"Qu7"</span>, <span class="st">"Qu8"</span>, <span class="st">"Qu12"</span>, <span class="st">"Qu13"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="bjwekafbua" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#bjwekafbua table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#bjwekafbua thead, #bjwekafbua tbody, #bjwekafbua tfoot, #bjwekafbua tr, #bjwekafbua td, #bjwekafbua th {
  border-style: none;
}

#bjwekafbua p {
  margin: 0;
  padding: 0;
}

#bjwekafbua .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#bjwekafbua .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#bjwekafbua .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#bjwekafbua .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#bjwekafbua .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#bjwekafbua .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#bjwekafbua .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#bjwekafbua .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#bjwekafbua .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#bjwekafbua .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#bjwekafbua .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#bjwekafbua .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#bjwekafbua .gt_spanner_row {
  border-bottom-style: hidden;
}

#bjwekafbua .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#bjwekafbua .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#bjwekafbua .gt_from_md > :first-child {
  margin-top: 0;
}

#bjwekafbua .gt_from_md > :last-child {
  margin-bottom: 0;
}

#bjwekafbua .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#bjwekafbua .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#bjwekafbua .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#bjwekafbua .gt_row_group_first td {
  border-top-width: 2px;
}

#bjwekafbua .gt_row_group_first th {
  border-top-width: 2px;
}

#bjwekafbua .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#bjwekafbua .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#bjwekafbua .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#bjwekafbua .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#bjwekafbua .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#bjwekafbua .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#bjwekafbua .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#bjwekafbua .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#bjwekafbua .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#bjwekafbua .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#bjwekafbua .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#bjwekafbua .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#bjwekafbua .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#bjwekafbua .gt_left {
  text-align: left;
}

#bjwekafbua .gt_center {
  text-align: center;
}

#bjwekafbua .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#bjwekafbua .gt_font_normal {
  font-weight: normal;
}

#bjwekafbua .gt_font_bold {
  font-weight: bold;
}

#bjwekafbua .gt_font_italic {
  font-style: italic;
}

#bjwekafbua .gt_super {
  font-size: 65%;
}

#bjwekafbua .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#bjwekafbua .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#bjwekafbua .gt_indent_1 {
  text-indent: 5px;
}

#bjwekafbua .gt_indent_2 {
  text-indent: 10px;
}

#bjwekafbua .gt_indent_3 {
  text-indent: 15px;
}

#bjwekafbua .gt_indent_4 {
  text-indent: 20px;
}

#bjwekafbua .gt_indent_5 {
  text-indent: 25px;
}

#bjwekafbua .katex-display {
  display: inline-flex !important;
  margin-bottom: 0.75em !important;
}

#bjwekafbua div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {
  height: 0px !important;
}
</style>

<table class="gt_table caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-quarto-disable-processing="false" data-quarto-bootstrap="false">
<colgroup>
<col style="width: 12%">
<col style="width: 12%">
<col style="width: 12%">
<col style="width: 12%">
<col style="width: 12%">
<col style="width: 12%">
<col style="width: 12%">
<col style="width: 12%">
</colgroup>
<thead>
<tr class="header gt_col_headings">
<th id="label" class="gt_col_heading gt_columns_bottom_border gt_left" data-quarto-table-cell-role="th" scope="col"><strong>Characteristic</strong></th>
<th id="stat_1" class="gt_col_heading gt_columns_bottom_border gt_center" data-quarto-table-cell-role="th" scope="col"><strong>Strongly Agree</strong><br> N = 30<span class="gt_footnote_marks" style="white-space:nowrap;font-style:italic;font-weight:normal;line-height:0;"><sup>1</sup></span></th>
<th id="stat_2" class="gt_col_heading gt_columns_bottom_border gt_center" data-quarto-table-cell-role="th" scope="col"><strong>Agree</strong><br> N = 136<span class="gt_footnote_marks" style="white-space:nowrap;font-style:italic;font-weight:normal;line-height:0;"><sup>1</sup></span></th>
<th id="stat_3" class="gt_col_heading gt_columns_bottom_border gt_center" data-quarto-table-cell-role="th" scope="col"><strong>Agree Somewhat</strong><br> N = 406<span class="gt_footnote_marks" style="white-space:nowrap;font-style:italic;font-weight:normal;line-height:0;"><sup>1</sup></span></th>
<th id="stat_4" class="gt_col_heading gt_columns_bottom_border gt_center" data-quarto-table-cell-role="th" scope="col"><strong>Undecided</strong><br> N = 726<span class="gt_footnote_marks" style="white-space:nowrap;font-style:italic;font-weight:normal;line-height:0;"><sup>1</sup></span></th>
<th id="stat_5" class="gt_col_heading gt_columns_bottom_border gt_center" data-quarto-table-cell-role="th" scope="col"><strong>Disagree Somewhat</strong><br> N = 769<span class="gt_footnote_marks" style="white-space:nowrap;font-style:italic;font-weight:normal;line-height:0;"><sup>1</sup></span></th>
<th id="stat_6" class="gt_col_heading gt_columns_bottom_border gt_center" data-quarto-table-cell-role="th" scope="col"><strong>Disagree</strong><br> N = 206<span class="gt_footnote_marks" style="white-space:nowrap;font-style:italic;font-weight:normal;line-height:0;"><sup>1</sup></span></th>
<th id="stat_7" class="gt_col_heading gt_columns_bottom_border gt_center" data-quarto-table-cell-role="th" scope="col"><strong>Strongly Disagree</strong><br> N = 247<span class="gt_footnote_marks" style="white-space:nowrap;font-style:italic;font-weight:normal;line-height:0;"><sup>1</sup></span></th>
</tr>
</thead>
<tbody class="gt_table_body">
<tr class="odd">
<td class="gt_row gt_left" headers="label"></td>
<td class="gt_row gt_center" headers="stat_1"><br>
</td>
<td class="gt_row gt_center" headers="stat_2"><br>
</td>
<td class="gt_row gt_center" headers="stat_3"><br>
</td>
<td class="gt_row gt_center" headers="stat_4"><br>
</td>
<td class="gt_row gt_center" headers="stat_5"><br>
</td>
<td class="gt_row gt_center" headers="stat_6"><br>
</td>
<td class="gt_row gt_center" headers="stat_7"><br>
</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="label">&nbsp;&nbsp;&nbsp;&nbsp;Qu3</td>
<td class="gt_row gt_center" headers="stat_1">1 (0.3%)</td>
<td class="gt_row gt_center" headers="stat_2">19 (6.0%)</td>
<td class="gt_row gt_center" headers="stat_3">54 (17%)</td>
<td class="gt_row gt_center" headers="stat_4">97 (31%)</td>
<td class="gt_row gt_center" headers="stat_5">94 (30%)</td>
<td class="gt_row gt_center" headers="stat_6">27 (8.6%)</td>
<td class="gt_row gt_center" headers="stat_7">23 (7.3%)</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="label">&nbsp;&nbsp;&nbsp;&nbsp;Qu4</td>
<td class="gt_row gt_center" headers="stat_1">1 (0.3%)</td>
<td class="gt_row gt_center" headers="stat_2">12 (3.8%)</td>
<td class="gt_row gt_center" headers="stat_3">53 (17%)</td>
<td class="gt_row gt_center" headers="stat_4">106 (34%)</td>
<td class="gt_row gt_center" headers="stat_5">91 (29%)</td>
<td class="gt_row gt_center" headers="stat_6">25 (7.9%)</td>
<td class="gt_row gt_center" headers="stat_7">27 (8.6%)</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="label">&nbsp;&nbsp;&nbsp;&nbsp;Qu5</td>
<td class="gt_row gt_center" headers="stat_1">1 (0.3%)</td>
<td class="gt_row gt_center" headers="stat_2">19 (6.0%)</td>
<td class="gt_row gt_center" headers="stat_3">61 (19%)</td>
<td class="gt_row gt_center" headers="stat_4">88 (28%)</td>
<td class="gt_row gt_center" headers="stat_5">102 (32%)</td>
<td class="gt_row gt_center" headers="stat_6">23 (7.3%)</td>
<td class="gt_row gt_center" headers="stat_7">21 (6.7%)</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="label">&nbsp;&nbsp;&nbsp;&nbsp;Qu6</td>
<td class="gt_row gt_center" headers="stat_1">3 (1.0%)</td>
<td class="gt_row gt_center" headers="stat_2">13 (4.1%)</td>
<td class="gt_row gt_center" headers="stat_3">45 (14%)</td>
<td class="gt_row gt_center" headers="stat_4">102 (32%)</td>
<td class="gt_row gt_center" headers="stat_5">104 (33%)</td>
<td class="gt_row gt_center" headers="stat_6">25 (7.9%)</td>
<td class="gt_row gt_center" headers="stat_7">23 (7.3%)</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="label">&nbsp;&nbsp;&nbsp;&nbsp;Qu7</td>
<td class="gt_row gt_center" headers="stat_1">4 (1.3%)</td>
<td class="gt_row gt_center" headers="stat_2">11 (3.5%)</td>
<td class="gt_row gt_center" headers="stat_3">42 (13%)</td>
<td class="gt_row gt_center" headers="stat_4">99 (31%)</td>
<td class="gt_row gt_center" headers="stat_5">90 (29%)</td>
<td class="gt_row gt_center" headers="stat_6">37 (12%)</td>
<td class="gt_row gt_center" headers="stat_7">32 (10%)</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="label">&nbsp;&nbsp;&nbsp;&nbsp;Qu8</td>
<td class="gt_row gt_center" headers="stat_1">7 (2.2%)</td>
<td class="gt_row gt_center" headers="stat_2">7 (2.2%)</td>
<td class="gt_row gt_center" headers="stat_3">42 (13%)</td>
<td class="gt_row gt_center" headers="stat_4">68 (22%)</td>
<td class="gt_row gt_center" headers="stat_5">119 (38%)</td>
<td class="gt_row gt_center" headers="stat_6">42 (13%)</td>
<td class="gt_row gt_center" headers="stat_7">30 (9.5%)</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="label">&nbsp;&nbsp;&nbsp;&nbsp;Qu12</td>
<td class="gt_row gt_center" headers="stat_1">1 (0.3%)</td>
<td class="gt_row gt_center" headers="stat_2">26 (8.3%)</td>
<td class="gt_row gt_center" headers="stat_3">44 (14%)</td>
<td class="gt_row gt_center" headers="stat_4">76 (24%)</td>
<td class="gt_row gt_center" headers="stat_5">83 (26%)</td>
<td class="gt_row gt_center" headers="stat_6">16 (5.1%)</td>
<td class="gt_row gt_center" headers="stat_7">69 (22%)</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="label">&nbsp;&nbsp;&nbsp;&nbsp;Qu13</td>
<td class="gt_row gt_center" headers="stat_1">12 (3.8%)</td>
<td class="gt_row gt_center" headers="stat_2">29 (9.2%)</td>
<td class="gt_row gt_center" headers="stat_3">65 (21%)</td>
<td class="gt_row gt_center" headers="stat_4">90 (29%)</td>
<td class="gt_row gt_center" headers="stat_5">86 (27%)</td>
<td class="gt_row gt_center" headers="stat_6">11 (3.5%)</td>
<td class="gt_row gt_center" headers="stat_7">22 (7.0%)</td>
</tr>
</tbody><tfoot class="gt_footnotes">
<tr class="even">
<td colspan="8" class="gt_footnote"><span class="gt_footnote_marks" style="white-space:nowrap;font-style:italic;font-weight:normal;line-height:0;"><sup>1</sup></span> n (%)</td>
</tr>
</tfoot>

</table>

</div>
</div>
</div>
</div>
<div id="tabset-1-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-1-2-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="fu">gt_items</span>(<span class="fu">c</span>(<span class="st">"Qu2"</span>, <span class="st">"Qu14"</span>, <span class="st">"Qu15"</span>, <span class="st">"Qu16"</span>, <span class="st">"Qu17"</span>, <span class="st">"Qu18"</span>, <span class="st">"Qu19"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="glygddaiao" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#glygddaiao table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#glygddaiao thead, #glygddaiao tbody, #glygddaiao tfoot, #glygddaiao tr, #glygddaiao td, #glygddaiao th {
  border-style: none;
}

#glygddaiao p {
  margin: 0;
  padding: 0;
}

#glygddaiao .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#glygddaiao .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#glygddaiao .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#glygddaiao .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#glygddaiao .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#glygddaiao .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#glygddaiao .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#glygddaiao .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#glygddaiao .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#glygddaiao .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#glygddaiao .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#glygddaiao .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#glygddaiao .gt_spanner_row {
  border-bottom-style: hidden;
}

#glygddaiao .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#glygddaiao .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#glygddaiao .gt_from_md > :first-child {
  margin-top: 0;
}

#glygddaiao .gt_from_md > :last-child {
  margin-bottom: 0;
}

#glygddaiao .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#glygddaiao .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#glygddaiao .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#glygddaiao .gt_row_group_first td {
  border-top-width: 2px;
}

#glygddaiao .gt_row_group_first th {
  border-top-width: 2px;
}

#glygddaiao .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#glygddaiao .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#glygddaiao .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#glygddaiao .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#glygddaiao .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#glygddaiao .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#glygddaiao .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#glygddaiao .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#glygddaiao .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#glygddaiao .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#glygddaiao .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#glygddaiao .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#glygddaiao .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#glygddaiao .gt_left {
  text-align: left;
}

#glygddaiao .gt_center {
  text-align: center;
}

#glygddaiao .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#glygddaiao .gt_font_normal {
  font-weight: normal;
}

#glygddaiao .gt_font_bold {
  font-weight: bold;
}

#glygddaiao .gt_font_italic {
  font-style: italic;
}

#glygddaiao .gt_super {
  font-size: 65%;
}

#glygddaiao .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#glygddaiao .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#glygddaiao .gt_indent_1 {
  text-indent: 5px;
}

#glygddaiao .gt_indent_2 {
  text-indent: 10px;
}

#glygddaiao .gt_indent_3 {
  text-indent: 15px;
}

#glygddaiao .gt_indent_4 {
  text-indent: 20px;
}

#glygddaiao .gt_indent_5 {
  text-indent: 25px;
}

#glygddaiao .katex-display {
  display: inline-flex !important;
  margin-bottom: 0.75em !important;
}

#glygddaiao div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {
  height: 0px !important;
}
</style>

<table class="gt_table caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-quarto-disable-processing="false" data-quarto-bootstrap="false">
<colgroup>
<col style="width: 12%">
<col style="width: 12%">
<col style="width: 12%">
<col style="width: 12%">
<col style="width: 12%">
<col style="width: 12%">
<col style="width: 12%">
<col style="width: 12%">
</colgroup>
<thead>
<tr class="header gt_col_headings">
<th id="label" class="gt_col_heading gt_columns_bottom_border gt_left" data-quarto-table-cell-role="th" scope="col"><strong>Characteristic</strong></th>
<th id="stat_1" class="gt_col_heading gt_columns_bottom_border gt_center" data-quarto-table-cell-role="th" scope="col"><strong>Strongly Agree</strong><br> N = 49<span class="gt_footnote_marks" style="white-space:nowrap;font-style:italic;font-weight:normal;line-height:0;"><sup>1</sup></span></th>
<th id="stat_2" class="gt_col_heading gt_columns_bottom_border gt_center" data-quarto-table-cell-role="th" scope="col"><strong>Agree</strong><br> N = 185<span class="gt_footnote_marks" style="white-space:nowrap;font-style:italic;font-weight:normal;line-height:0;"><sup>1</sup></span></th>
<th id="stat_3" class="gt_col_heading gt_columns_bottom_border gt_center" data-quarto-table-cell-role="th" scope="col"><strong>Agree Somewhat</strong><br> N = 430<span class="gt_footnote_marks" style="white-space:nowrap;font-style:italic;font-weight:normal;line-height:0;"><sup>1</sup></span></th>
<th id="stat_4" class="gt_col_heading gt_columns_bottom_border gt_center" data-quarto-table-cell-role="th" scope="col"><strong>Undecided</strong><br> N = 628<span class="gt_footnote_marks" style="white-space:nowrap;font-style:italic;font-weight:normal;line-height:0;"><sup>1</sup></span></th>
<th id="stat_5" class="gt_col_heading gt_columns_bottom_border gt_center" data-quarto-table-cell-role="th" scope="col"><strong>Disagree Somewhat</strong><br> N = 553<span class="gt_footnote_marks" style="white-space:nowrap;font-style:italic;font-weight:normal;line-height:0;"><sup>1</sup></span></th>
<th id="stat_6" class="gt_col_heading gt_columns_bottom_border gt_center" data-quarto-table-cell-role="th" scope="col"><strong>Disagree</strong><br> N = 267<span class="gt_footnote_marks" style="white-space:nowrap;font-style:italic;font-weight:normal;line-height:0;"><sup>1</sup></span></th>
<th id="stat_7" class="gt_col_heading gt_columns_bottom_border gt_center" data-quarto-table-cell-role="th" scope="col"><strong>Strongly Disagree</strong><br> N = 93<span class="gt_footnote_marks" style="white-space:nowrap;font-style:italic;font-weight:normal;line-height:0;"><sup>1</sup></span></th>
</tr>
</thead>
<tbody class="gt_table_body">
<tr class="odd">
<td class="gt_row gt_left" headers="label"></td>
<td class="gt_row gt_center" headers="stat_1"><br>
</td>
<td class="gt_row gt_center" headers="stat_2"><br>
</td>
<td class="gt_row gt_center" headers="stat_3"><br>
</td>
<td class="gt_row gt_center" headers="stat_4"><br>
</td>
<td class="gt_row gt_center" headers="stat_5"><br>
</td>
<td class="gt_row gt_center" headers="stat_6"><br>
</td>
<td class="gt_row gt_center" headers="stat_7"><br>
</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="label">&nbsp;&nbsp;&nbsp;&nbsp;Qu2</td>
<td class="gt_row gt_center" headers="stat_1">15 (4.8%)</td>
<td class="gt_row gt_center" headers="stat_2">31 (9.8%)</td>
<td class="gt_row gt_center" headers="stat_3">51 (16%)</td>
<td class="gt_row gt_center" headers="stat_4">79 (25%)</td>
<td class="gt_row gt_center" headers="stat_5">69 (22%)</td>
<td class="gt_row gt_center" headers="stat_6">51 (16%)</td>
<td class="gt_row gt_center" headers="stat_7">19 (6.0%)</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="label">&nbsp;&nbsp;&nbsp;&nbsp;Qu14</td>
<td class="gt_row gt_center" headers="stat_1">2 (0.6%)</td>
<td class="gt_row gt_center" headers="stat_2">31 (9.8%)</td>
<td class="gt_row gt_center" headers="stat_3">53 (17%)</td>
<td class="gt_row gt_center" headers="stat_4">101 (32%)</td>
<td class="gt_row gt_center" headers="stat_5">85 (27%)</td>
<td class="gt_row gt_center" headers="stat_6">30 (9.5%)</td>
<td class="gt_row gt_center" headers="stat_7">13 (4.1%)</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="label">&nbsp;&nbsp;&nbsp;&nbsp;Qu15</td>
<td class="gt_row gt_center" headers="stat_1">4 (1.3%)</td>
<td class="gt_row gt_center" headers="stat_2">26 (8.3%)</td>
<td class="gt_row gt_center" headers="stat_3">67 (21%)</td>
<td class="gt_row gt_center" headers="stat_4">92 (29%)</td>
<td class="gt_row gt_center" headers="stat_5">80 (25%)</td>
<td class="gt_row gt_center" headers="stat_6">33 (10%)</td>
<td class="gt_row gt_center" headers="stat_7">13 (4.1%)</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="label">&nbsp;&nbsp;&nbsp;&nbsp;Qu16</td>
<td class="gt_row gt_center" headers="stat_1">7 (2.2%)</td>
<td class="gt_row gt_center" headers="stat_2">25 (7.9%)</td>
<td class="gt_row gt_center" headers="stat_3">66 (21%)</td>
<td class="gt_row gt_center" headers="stat_4">77 (24%)</td>
<td class="gt_row gt_center" headers="stat_5">90 (29%)</td>
<td class="gt_row gt_center" headers="stat_6">39 (12%)</td>
<td class="gt_row gt_center" headers="stat_7">11 (3.5%)</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="label">&nbsp;&nbsp;&nbsp;&nbsp;Qu17</td>
<td class="gt_row gt_center" headers="stat_1">12 (3.8%)</td>
<td class="gt_row gt_center" headers="stat_2">29 (9.2%)</td>
<td class="gt_row gt_center" headers="stat_3">80 (25%)</td>
<td class="gt_row gt_center" headers="stat_4">94 (30%)</td>
<td class="gt_row gt_center" headers="stat_5">71 (23%)</td>
<td class="gt_row gt_center" headers="stat_6">24 (7.6%)</td>
<td class="gt_row gt_center" headers="stat_7">5 (1.6%)</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="label">&nbsp;&nbsp;&nbsp;&nbsp;Qu18</td>
<td class="gt_row gt_center" headers="stat_1">5 (1.6%)</td>
<td class="gt_row gt_center" headers="stat_2">33 (10%)</td>
<td class="gt_row gt_center" headers="stat_3">69 (22%)</td>
<td class="gt_row gt_center" headers="stat_4">97 (31%)</td>
<td class="gt_row gt_center" headers="stat_5">73 (23%)</td>
<td class="gt_row gt_center" headers="stat_6">25 (7.9%)</td>
<td class="gt_row gt_center" headers="stat_7">13 (4.1%)</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="label">&nbsp;&nbsp;&nbsp;&nbsp;Qu19</td>
<td class="gt_row gt_center" headers="stat_1">4 (1.3%)</td>
<td class="gt_row gt_center" headers="stat_2">10 (3.2%)</td>
<td class="gt_row gt_center" headers="stat_3">44 (14%)</td>
<td class="gt_row gt_center" headers="stat_4">88 (28%)</td>
<td class="gt_row gt_center" headers="stat_5">85 (27%)</td>
<td class="gt_row gt_center" headers="stat_6">65 (21%)</td>
<td class="gt_row gt_center" headers="stat_7">19 (6.0%)</td>
</tr>
</tbody><tfoot class="gt_footnotes">
<tr class="odd">
<td colspan="8" class="gt_footnote"><span class="gt_footnote_marks" style="white-space:nowrap;font-style:italic;font-weight:normal;line-height:0;"><sup>1</sup></span> n (%)</td>
</tr>
</tfoot>

</table>

</div>
</div>
</div>
</div>
<div id="tabset-1-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-1-3-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="fu">gt_items</span>(<span class="fu">c</span>(<span class="st">"Qu20"</span>, <span class="st">"Qu21"</span>, <span class="st">"Qu22"</span>, <span class="st">"Qu23"</span>, <span class="st">"Qu24"</span>, <span class="st">"Qu25"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="enpwfwwjgf" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#enpwfwwjgf table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#enpwfwwjgf thead, #enpwfwwjgf tbody, #enpwfwwjgf tfoot, #enpwfwwjgf tr, #enpwfwwjgf td, #enpwfwwjgf th {
  border-style: none;
}

#enpwfwwjgf p {
  margin: 0;
  padding: 0;
}

#enpwfwwjgf .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#enpwfwwjgf .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#enpwfwwjgf .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#enpwfwwjgf .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#enpwfwwjgf .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#enpwfwwjgf .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#enpwfwwjgf .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#enpwfwwjgf .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#enpwfwwjgf .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#enpwfwwjgf .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#enpwfwwjgf .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#enpwfwwjgf .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#enpwfwwjgf .gt_spanner_row {
  border-bottom-style: hidden;
}

#enpwfwwjgf .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#enpwfwwjgf .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#enpwfwwjgf .gt_from_md > :first-child {
  margin-top: 0;
}

#enpwfwwjgf .gt_from_md > :last-child {
  margin-bottom: 0;
}

#enpwfwwjgf .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#enpwfwwjgf .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#enpwfwwjgf .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#enpwfwwjgf .gt_row_group_first td {
  border-top-width: 2px;
}

#enpwfwwjgf .gt_row_group_first th {
  border-top-width: 2px;
}

#enpwfwwjgf .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#enpwfwwjgf .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#enpwfwwjgf .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#enpwfwwjgf .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#enpwfwwjgf .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#enpwfwwjgf .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#enpwfwwjgf .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#enpwfwwjgf .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#enpwfwwjgf .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#enpwfwwjgf .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#enpwfwwjgf .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#enpwfwwjgf .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#enpwfwwjgf .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#enpwfwwjgf .gt_left {
  text-align: left;
}

#enpwfwwjgf .gt_center {
  text-align: center;
}

#enpwfwwjgf .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#enpwfwwjgf .gt_font_normal {
  font-weight: normal;
}

#enpwfwwjgf .gt_font_bold {
  font-weight: bold;
}

#enpwfwwjgf .gt_font_italic {
  font-style: italic;
}

#enpwfwwjgf .gt_super {
  font-size: 65%;
}

#enpwfwwjgf .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#enpwfwwjgf .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#enpwfwwjgf .gt_indent_1 {
  text-indent: 5px;
}

#enpwfwwjgf .gt_indent_2 {
  text-indent: 10px;
}

#enpwfwwjgf .gt_indent_3 {
  text-indent: 15px;
}

#enpwfwwjgf .gt_indent_4 {
  text-indent: 20px;
}

#enpwfwwjgf .gt_indent_5 {
  text-indent: 25px;
}

#enpwfwwjgf .katex-display {
  display: inline-flex !important;
  margin-bottom: 0.75em !important;
}

#enpwfwwjgf div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {
  height: 0px !important;
}
</style>

<table class="gt_table caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-quarto-disable-processing="false" data-quarto-bootstrap="false">
<colgroup>
<col style="width: 12%">
<col style="width: 12%">
<col style="width: 12%">
<col style="width: 12%">
<col style="width: 12%">
<col style="width: 12%">
<col style="width: 12%">
<col style="width: 12%">
</colgroup>
<thead>
<tr class="header gt_col_headings">
<th id="label" class="gt_col_heading gt_columns_bottom_border gt_left" data-quarto-table-cell-role="th" scope="col"><strong>Characteristic</strong></th>
<th id="stat_1" class="gt_col_heading gt_columns_bottom_border gt_center" data-quarto-table-cell-role="th" scope="col"><strong>Strongly Agree</strong><br> N = 107<span class="gt_footnote_marks" style="white-space:nowrap;font-style:italic;font-weight:normal;line-height:0;"><sup>1</sup></span></th>
<th id="stat_2" class="gt_col_heading gt_columns_bottom_border gt_center" data-quarto-table-cell-role="th" scope="col"><strong>Agree</strong><br> N = 308<span class="gt_footnote_marks" style="white-space:nowrap;font-style:italic;font-weight:normal;line-height:0;"><sup>1</sup></span></th>
<th id="stat_3" class="gt_col_heading gt_columns_bottom_border gt_center" data-quarto-table-cell-role="th" scope="col"><strong>Agree Somewhat</strong><br> N = 562<span class="gt_footnote_marks" style="white-space:nowrap;font-style:italic;font-weight:normal;line-height:0;"><sup>1</sup></span></th>
<th id="stat_4" class="gt_col_heading gt_columns_bottom_border gt_center" data-quarto-table-cell-role="th" scope="col"><strong>Undecided</strong><br> N = 492<span class="gt_footnote_marks" style="white-space:nowrap;font-style:italic;font-weight:normal;line-height:0;"><sup>1</sup></span></th>
<th id="stat_5" class="gt_col_heading gt_columns_bottom_border gt_center" data-quarto-table-cell-role="th" scope="col"><strong>Disagree Somewhat</strong><br> N = 372<span class="gt_footnote_marks" style="white-space:nowrap;font-style:italic;font-weight:normal;line-height:0;"><sup>1</sup></span></th>
<th id="stat_6" class="gt_col_heading gt_columns_bottom_border gt_center" data-quarto-table-cell-role="th" scope="col"><strong>Disagree</strong><br> N = 28<span class="gt_footnote_marks" style="white-space:nowrap;font-style:italic;font-weight:normal;line-height:0;"><sup>1</sup></span></th>
<th id="stat_7" class="gt_col_heading gt_columns_bottom_border gt_center" data-quarto-table-cell-role="th" scope="col"><strong>Strongly Disagree</strong><br> N = 21<span class="gt_footnote_marks" style="white-space:nowrap;font-style:italic;font-weight:normal;line-height:0;"><sup>1</sup></span></th>
</tr>
</thead>
<tbody class="gt_table_body">
<tr class="odd">
<td class="gt_row gt_left" headers="label"></td>
<td class="gt_row gt_center" headers="stat_1"><br>
</td>
<td class="gt_row gt_center" headers="stat_2"><br>
</td>
<td class="gt_row gt_center" headers="stat_3"><br>
</td>
<td class="gt_row gt_center" headers="stat_4"><br>
</td>
<td class="gt_row gt_center" headers="stat_5"><br>
</td>
<td class="gt_row gt_center" headers="stat_6"><br>
</td>
<td class="gt_row gt_center" headers="stat_7"><br>
</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="label">&nbsp;&nbsp;&nbsp;&nbsp;Qu20</td>
<td class="gt_row gt_center" headers="stat_1">8 (2.5%)</td>
<td class="gt_row gt_center" headers="stat_2">37 (12%)</td>
<td class="gt_row gt_center" headers="stat_3">74 (23%)</td>
<td class="gt_row gt_center" headers="stat_4">83 (26%)</td>
<td class="gt_row gt_center" headers="stat_5">87 (28%)</td>
<td class="gt_row gt_center" headers="stat_6">17 (5.4%)</td>
<td class="gt_row gt_center" headers="stat_7">9 (2.9%)</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="label">&nbsp;&nbsp;&nbsp;&nbsp;Qu21</td>
<td class="gt_row gt_center" headers="stat_1">20 (6.3%)</td>
<td class="gt_row gt_center" headers="stat_2">67 (21%)</td>
<td class="gt_row gt_center" headers="stat_3">103 (33%)</td>
<td class="gt_row gt_center" headers="stat_4">63 (20%)</td>
<td class="gt_row gt_center" headers="stat_5">60 (19%)</td>
<td class="gt_row gt_center" headers="stat_6">0 (0%)</td>
<td class="gt_row gt_center" headers="stat_7">2 (0.6%)</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="label">&nbsp;&nbsp;&nbsp;&nbsp;Qu22</td>
<td class="gt_row gt_center" headers="stat_1">23 (7.3%)</td>
<td class="gt_row gt_center" headers="stat_2">68 (22%)</td>
<td class="gt_row gt_center" headers="stat_3">114 (36%)</td>
<td class="gt_row gt_center" headers="stat_4">59 (19%)</td>
<td class="gt_row gt_center" headers="stat_5">49 (16%)</td>
<td class="gt_row gt_center" headers="stat_6">0 (0%)</td>
<td class="gt_row gt_center" headers="stat_7">2 (0.6%)</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="label">&nbsp;&nbsp;&nbsp;&nbsp;Qu23</td>
<td class="gt_row gt_center" headers="stat_1">16 (5.1%)</td>
<td class="gt_row gt_center" headers="stat_2">46 (15%)</td>
<td class="gt_row gt_center" headers="stat_3">87 (28%)</td>
<td class="gt_row gt_center" headers="stat_4">84 (27%)</td>
<td class="gt_row gt_center" headers="stat_5">74 (23%)</td>
<td class="gt_row gt_center" headers="stat_6">2 (0.6%)</td>
<td class="gt_row gt_center" headers="stat_7">6 (1.9%)</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="label">&nbsp;&nbsp;&nbsp;&nbsp;Qu24</td>
<td class="gt_row gt_center" headers="stat_1">21 (6.7%)</td>
<td class="gt_row gt_center" headers="stat_2">55 (17%)</td>
<td class="gt_row gt_center" headers="stat_3">95 (30%)</td>
<td class="gt_row gt_center" headers="stat_4">96 (30%)</td>
<td class="gt_row gt_center" headers="stat_5">48 (15%)</td>
<td class="gt_row gt_center" headers="stat_6">0 (0%)</td>
<td class="gt_row gt_center" headers="stat_7">0 (0%)</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="label">&nbsp;&nbsp;&nbsp;&nbsp;Qu25</td>
<td class="gt_row gt_center" headers="stat_1">19 (6.0%)</td>
<td class="gt_row gt_center" headers="stat_2">35 (11%)</td>
<td class="gt_row gt_center" headers="stat_3">89 (28%)</td>
<td class="gt_row gt_center" headers="stat_4">107 (34%)</td>
<td class="gt_row gt_center" headers="stat_5">54 (17%)</td>
<td class="gt_row gt_center" headers="stat_6">9 (2.9%)</td>
<td class="gt_row gt_center" headers="stat_7">2 (0.6%)</td>
</tr>
</tbody><tfoot class="gt_footnotes">
<tr class="even">
<td colspan="8" class="gt_footnote"><span class="gt_footnote_marks" style="white-space:nowrap;font-style:italic;font-weight:normal;line-height:0;"><sup>1</sup></span> n (%)</td>
</tr>
</tfoot>

</table>

</div>
</div>
</div>
</div>
<div id="tabset-1-4" class="tab-pane" role="tabpanel" aria-labelledby="tabset-1-4-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="fu">gt_items</span>(<span class="fu">c</span>(<span class="st">"Qu1"</span>, <span class="st">"Qu9"</span>, <span class="st">"Qu10"</span>, <span class="st">"Qu11"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="umvyjiigdp" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#umvyjiigdp table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#umvyjiigdp thead, #umvyjiigdp tbody, #umvyjiigdp tfoot, #umvyjiigdp tr, #umvyjiigdp td, #umvyjiigdp th {
  border-style: none;
}

#umvyjiigdp p {
  margin: 0;
  padding: 0;
}

#umvyjiigdp .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#umvyjiigdp .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#umvyjiigdp .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#umvyjiigdp .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#umvyjiigdp .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#umvyjiigdp .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#umvyjiigdp .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#umvyjiigdp .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#umvyjiigdp .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#umvyjiigdp .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#umvyjiigdp .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#umvyjiigdp .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#umvyjiigdp .gt_spanner_row {
  border-bottom-style: hidden;
}

#umvyjiigdp .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#umvyjiigdp .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#umvyjiigdp .gt_from_md > :first-child {
  margin-top: 0;
}

#umvyjiigdp .gt_from_md > :last-child {
  margin-bottom: 0;
}

#umvyjiigdp .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#umvyjiigdp .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#umvyjiigdp .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#umvyjiigdp .gt_row_group_first td {
  border-top-width: 2px;
}

#umvyjiigdp .gt_row_group_first th {
  border-top-width: 2px;
}

#umvyjiigdp .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#umvyjiigdp .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#umvyjiigdp .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#umvyjiigdp .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#umvyjiigdp .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#umvyjiigdp .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#umvyjiigdp .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#umvyjiigdp .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#umvyjiigdp .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#umvyjiigdp .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#umvyjiigdp .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#umvyjiigdp .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#umvyjiigdp .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#umvyjiigdp .gt_left {
  text-align: left;
}

#umvyjiigdp .gt_center {
  text-align: center;
}

#umvyjiigdp .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#umvyjiigdp .gt_font_normal {
  font-weight: normal;
}

#umvyjiigdp .gt_font_bold {
  font-weight: bold;
}

#umvyjiigdp .gt_font_italic {
  font-style: italic;
}

#umvyjiigdp .gt_super {
  font-size: 65%;
}

#umvyjiigdp .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#umvyjiigdp .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#umvyjiigdp .gt_indent_1 {
  text-indent: 5px;
}

#umvyjiigdp .gt_indent_2 {
  text-indent: 10px;
}

#umvyjiigdp .gt_indent_3 {
  text-indent: 15px;
}

#umvyjiigdp .gt_indent_4 {
  text-indent: 20px;
}

#umvyjiigdp .gt_indent_5 {
  text-indent: 25px;
}

#umvyjiigdp .katex-display {
  display: inline-flex !important;
  margin-bottom: 0.75em !important;
}

#umvyjiigdp div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {
  height: 0px !important;
}
</style>

<table class="gt_table caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-quarto-disable-processing="false" data-quarto-bootstrap="false">
<colgroup>
<col style="width: 12%">
<col style="width: 12%">
<col style="width: 12%">
<col style="width: 12%">
<col style="width: 12%">
<col style="width: 12%">
<col style="width: 12%">
<col style="width: 12%">
</colgroup>
<thead>
<tr class="header gt_col_headings">
<th id="label" class="gt_col_heading gt_columns_bottom_border gt_left" data-quarto-table-cell-role="th" scope="col"><strong>Characteristic</strong></th>
<th id="stat_1" class="gt_col_heading gt_columns_bottom_border gt_center" data-quarto-table-cell-role="th" scope="col"><strong>Strongly Agree</strong><br> N = 25<span class="gt_footnote_marks" style="white-space:nowrap;font-style:italic;font-weight:normal;line-height:0;"><sup>1</sup></span></th>
<th id="stat_2" class="gt_col_heading gt_columns_bottom_border gt_center" data-quarto-table-cell-role="th" scope="col"><strong>Agree</strong><br> N = 60<span class="gt_footnote_marks" style="white-space:nowrap;font-style:italic;font-weight:normal;line-height:0;"><sup>1</sup></span></th>
<th id="stat_3" class="gt_col_heading gt_columns_bottom_border gt_center" data-quarto-table-cell-role="th" scope="col"><strong>Agree Somewhat</strong><br> N = 104<span class="gt_footnote_marks" style="white-space:nowrap;font-style:italic;font-weight:normal;line-height:0;"><sup>1</sup></span></th>
<th id="stat_4" class="gt_col_heading gt_columns_bottom_border gt_center" data-quarto-table-cell-role="th" scope="col"><strong>Undecided</strong><br> N = 149<span class="gt_footnote_marks" style="white-space:nowrap;font-style:italic;font-weight:normal;line-height:0;"><sup>1</sup></span></th>
<th id="stat_5" class="gt_col_heading gt_columns_bottom_border gt_center" data-quarto-table-cell-role="th" scope="col"><strong>Disagree Somewhat</strong><br> N = 484<span class="gt_footnote_marks" style="white-space:nowrap;font-style:italic;font-weight:normal;line-height:0;"><sup>1</sup></span></th>
<th id="stat_6" class="gt_col_heading gt_columns_bottom_border gt_center" data-quarto-table-cell-role="th" scope="col"><strong>Disagree</strong><br> N = 322<span class="gt_footnote_marks" style="white-space:nowrap;font-style:italic;font-weight:normal;line-height:0;"><sup>1</sup></span></th>
<th id="stat_7" class="gt_col_heading gt_columns_bottom_border gt_center" data-quarto-table-cell-role="th" scope="col"><strong>Strongly Disagree</strong><br> N = 116<span class="gt_footnote_marks" style="white-space:nowrap;font-style:italic;font-weight:normal;line-height:0;"><sup>1</sup></span></th>
</tr>
</thead>
<tbody class="gt_table_body">
<tr class="odd">
<td class="gt_row gt_left" headers="label"></td>
<td class="gt_row gt_center" headers="stat_1"><br>
</td>
<td class="gt_row gt_center" headers="stat_2"><br>
</td>
<td class="gt_row gt_center" headers="stat_3"><br>
</td>
<td class="gt_row gt_center" headers="stat_4"><br>
</td>
<td class="gt_row gt_center" headers="stat_5"><br>
</td>
<td class="gt_row gt_center" headers="stat_6"><br>
</td>
<td class="gt_row gt_center" headers="stat_7"><br>
</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="label">&nbsp;&nbsp;&nbsp;&nbsp;Qu1</td>
<td class="gt_row gt_center" headers="stat_1">7 (2.2%)</td>
<td class="gt_row gt_center" headers="stat_2">10 (3.2%)</td>
<td class="gt_row gt_center" headers="stat_3">20 (6.3%)</td>
<td class="gt_row gt_center" headers="stat_4">39 (12%)</td>
<td class="gt_row gt_center" headers="stat_5">114 (36%)</td>
<td class="gt_row gt_center" headers="stat_6">94 (30%)</td>
<td class="gt_row gt_center" headers="stat_7">31 (9.8%)</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="label">&nbsp;&nbsp;&nbsp;&nbsp;Qu9</td>
<td class="gt_row gt_center" headers="stat_1">4 (1.3%)</td>
<td class="gt_row gt_center" headers="stat_2">19 (6.0%)</td>
<td class="gt_row gt_center" headers="stat_3">21 (6.7%)</td>
<td class="gt_row gt_center" headers="stat_4">19 (6.0%)</td>
<td class="gt_row gt_center" headers="stat_5">117 (37%)</td>
<td class="gt_row gt_center" headers="stat_6">94 (30%)</td>
<td class="gt_row gt_center" headers="stat_7">41 (13%)</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="label">&nbsp;&nbsp;&nbsp;&nbsp;Qu10</td>
<td class="gt_row gt_center" headers="stat_1">9 (2.9%)</td>
<td class="gt_row gt_center" headers="stat_2">9 (2.9%)</td>
<td class="gt_row gt_center" headers="stat_3">25 (7.9%)</td>
<td class="gt_row gt_center" headers="stat_4">29 (9.2%)</td>
<td class="gt_row gt_center" headers="stat_5">129 (41%)</td>
<td class="gt_row gt_center" headers="stat_6">82 (26%)</td>
<td class="gt_row gt_center" headers="stat_7">32 (10%)</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="label">&nbsp;&nbsp;&nbsp;&nbsp;Qu11</td>
<td class="gt_row gt_center" headers="stat_1">5 (1.6%)</td>
<td class="gt_row gt_center" headers="stat_2">22 (7.0%)</td>
<td class="gt_row gt_center" headers="stat_3">38 (12%)</td>
<td class="gt_row gt_center" headers="stat_4">62 (20%)</td>
<td class="gt_row gt_center" headers="stat_5">124 (39%)</td>
<td class="gt_row gt_center" headers="stat_6">52 (17%)</td>
<td class="gt_row gt_center" headers="stat_7">12 (3.8%)</td>
</tr>
</tbody><tfoot class="gt_footnotes">
<tr class="even">
<td colspan="8" class="gt_footnote"><span class="gt_footnote_marks" style="white-space:nowrap;font-style:italic;font-weight:normal;line-height:0;"><sup>1</sup></span> n (%)</td>
</tr>
</tfoot>

</table>

</div>
</div>
</div>
</div>
</div>
</div>
</section>
<section id="assumptions" class="level2" data-number="2.3">
<h2 data-number="2.3" class="anchored" data-anchor-id="assumptions"><span class="header-section-number">2.3</span> Assumptions</h2>
<p>Missing values can bias PCA results. If you have missing values, you should either impute, remove the observations, or drop the columns. Fortunately there are no missing values in this dataset.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="fu">colSums</span>(<span class="fu">is.na</span>(pca_dat))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   Qu1    Qu2    Qu3    Qu4    Qu5    Qu6    Qu7    Qu8    Qu9   Qu10   Qu11 
     0      0      0      0      0      0      0      0      0      0      0 
  Qu12   Qu13   Qu14   Qu15   Qu16   Qu17   Qu18   Qu19   Qu20   Qu21   Qu22 
     0      0      0      0      0      0      0      0      0      0      0 
  Qu23   Qu24   Qu25 FAC1_1 FAC2_1 FAC3_1 FAC4_1 FAC5_1 
     0      0      0      0      0      0      0      0 </code></pre>
</div>
</div>
<p>Let’s drop the unrelated <code>FAC*</code> cols. PCA only works with numerical values. Our questionnaire uses a 7-level scale, so we’re probably okay to treat that as numeric. The data should also be normalized (subtract mean, divide by SD). Note that the <code>scale()</code> function returns the data as a matrix (fine).</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>pca_numeric <span class="ot">&lt;-</span></span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>  pca_dat <span class="sc">|&gt;</span></span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="fu">starts_with</span>(<span class="st">"Qu"</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="fu">across</span>(<span class="fu">everything</span>(), as.numeric)) <span class="sc">|&gt;</span></span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale</span>()</span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-7"><a href="#cb15-7" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(pca_numeric)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> num [1:315, 1:25] -1.5742 0.718 -0.0461 -0.8102 -0.8102 ...
 - attr(*, "dimnames")=List of 2
  ..$ : NULL
  ..$ : chr [1:25] "Qu1" "Qu2" "Qu3" "Qu4" ...
 - attr(*, "scaled:center")= Named num [1:25] 5.06 4.22 4.39 4.45 4.35 ...
  ..- attr(*, "names")= chr [1:25] "Qu1" "Qu2" "Qu3" "Qu4" ...
 - attr(*, "scaled:scale")= Named num [1:25] 1.31 1.53 1.26 1.24 1.25 ...
  ..- attr(*, "names")= chr [1:25] "Qu1" "Qu2" "Qu3" "Qu4" ...</code></pre>
</div>
</div>
<p>PCA is based on correlation coefficients, so all variables should be linearly related (<em>r</em> &gt; .3) to at least one other variable. You might test this with a correlation matrix scatterplot, but the number of relationships can get unwieldy.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a>corr_mtrx <span class="ot">&lt;-</span> <span class="fu">cor</span>(pca_numeric, <span class="at">method =</span> <span class="st">"pearson"</span>)</span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a>ggcorrplot<span class="sc">::</span><span class="fu">ggcorrplot</span>(corr_mtrx)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="02-pca_files/figure-html/unnamed-chunk-17-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Instead, just query the matrix for the max correlations. The worst is q20.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Load necessary library</span></span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Set seed for reproducibility</span></span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb18-6"><a href="#cb18-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-7"><a href="#cb18-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a toy dataset</span></span>
<span id="cb18-8"><a href="#cb18-8" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">100</span></span>
<span id="cb18-9"><a href="#cb18-9" aria-hidden="true" tabindex="-1"></a>var1 <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(n, <span class="at">mean =</span> <span class="dv">0</span>, <span class="at">sd =</span> <span class="dv">1</span>)</span>
<span id="cb18-10"><a href="#cb18-10" aria-hidden="true" tabindex="-1"></a>var2 <span class="ot">&lt;-</span> var1 <span class="sc">+</span> <span class="fu">rnorm</span>(n, <span class="at">mean =</span> <span class="dv">0</span>, <span class="at">sd =</span> <span class="fl">0.1</span>)  <span class="co"># Strongly correlated with var1</span></span>
<span id="cb18-11"><a href="#cb18-11" aria-hidden="true" tabindex="-1"></a>var3 <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(n, <span class="at">mean =</span> <span class="dv">0</span>, <span class="at">sd =</span> <span class="dv">1</span>)           <span class="co"># Weakly correlated with var1 and var2</span></span>
<span id="cb18-12"><a href="#cb18-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-13"><a href="#cb18-13" aria-hidden="true" tabindex="-1"></a>data <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(var1, var2, var3)</span>
<span id="cb18-14"><a href="#cb18-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-15"><a href="#cb18-15" aria-hidden="true" tabindex="-1"></a><span class="co"># Standardize the dataset</span></span>
<span id="cb18-16"><a href="#cb18-16" aria-hidden="true" tabindex="-1"></a>data_scaled <span class="ot">&lt;-</span> <span class="fu">scale</span>(data)</span>
<span id="cb18-17"><a href="#cb18-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-18"><a href="#cb18-18" aria-hidden="true" tabindex="-1"></a><span class="co"># Perform PCA</span></span>
<span id="cb18-19"><a href="#cb18-19" aria-hidden="true" tabindex="-1"></a>pca <span class="ot">&lt;-</span> <span class="fu">prcomp</span>(data_scaled, <span class="at">center =</span> <span class="cn">TRUE</span>, <span class="at">scale. =</span> <span class="cn">TRUE</span>)</span>
<span id="cb18-20"><a href="#cb18-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-21"><a href="#cb18-21" aria-hidden="true" tabindex="-1"></a><span class="co"># Summary of PCA</span></span>
<span id="cb18-22"><a href="#cb18-22" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(pca)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Importance of components:
                          PC1    PC2     PC3
Standard deviation     1.4234 0.9840 0.07486
Proportion of Variance 0.6754 0.3228 0.00187
Cumulative Proportion  0.6754 0.9981 1.00000</code></pre>
</div>
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Biplot of PCA</span></span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a><span class="fu">biplot</span>(pca)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="02-pca_files/figure-html/unnamed-chunk-18-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="fu">as_tibble</span>(corr_mtrx) <span class="sc">|&gt;</span></span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">var1 =</span> <span class="fu">factor</span>(q_colnames, <span class="at">levels =</span> q_colnames)) <span class="sc">|&gt;</span></span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> <span class="fu">c</span>(Qu1<span class="sc">:</span>Qu25), <span class="at">names_to =</span> <span class="st">"var2"</span>, <span class="at">values_to =</span> <span class="st">"rho"</span>) <span class="sc">|&gt;</span></span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(var1 <span class="sc">!=</span> var2) <span class="sc">|&gt;</span></span>
<span id="cb21-5"><a href="#cb21-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">slice_max</span>(<span class="at">by =</span> var1, <span class="at">order_by =</span> rho, <span class="at">n =</span> <span class="dv">1</span>) <span class="sc">|&gt;</span></span>
<span id="cb21-6"><a href="#cb21-6" aria-hidden="true" tabindex="-1"></a>  gt<span class="sc">::</span><span class="fu">gt</span>() <span class="sc">|&gt;</span> </span>
<span id="cb21-7"><a href="#cb21-7" aria-hidden="true" tabindex="-1"></a>  gt<span class="sc">::</span><span class="fu">data_color</span>(</span>
<span id="cb21-8"><a href="#cb21-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">columns =</span> rho, </span>
<span id="cb21-9"><a href="#cb21-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">method =</span> <span class="st">"numeric"</span>,</span>
<span id="cb21-10"><a href="#cb21-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">palette =</span> <span class="fu">c</span>(<span class="st">"white"</span>, <span class="st">"dodgerblue3"</span>),</span>
<span id="cb21-11"><a href="#cb21-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">domain =</span> <span class="fu">c</span>(<span class="fl">0.2</span>, .<span class="dv">9</span>)</span>
<span id="cb21-12"><a href="#cb21-12" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="pikksjwbyf" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#pikksjwbyf table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#pikksjwbyf thead, #pikksjwbyf tbody, #pikksjwbyf tfoot, #pikksjwbyf tr, #pikksjwbyf td, #pikksjwbyf th {
  border-style: none;
}

#pikksjwbyf p {
  margin: 0;
  padding: 0;
}

#pikksjwbyf .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#pikksjwbyf .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#pikksjwbyf .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#pikksjwbyf .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#pikksjwbyf .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#pikksjwbyf .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#pikksjwbyf .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#pikksjwbyf .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#pikksjwbyf .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#pikksjwbyf .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#pikksjwbyf .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#pikksjwbyf .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#pikksjwbyf .gt_spanner_row {
  border-bottom-style: hidden;
}

#pikksjwbyf .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#pikksjwbyf .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#pikksjwbyf .gt_from_md > :first-child {
  margin-top: 0;
}

#pikksjwbyf .gt_from_md > :last-child {
  margin-bottom: 0;
}

#pikksjwbyf .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#pikksjwbyf .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#pikksjwbyf .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#pikksjwbyf .gt_row_group_first td {
  border-top-width: 2px;
}

#pikksjwbyf .gt_row_group_first th {
  border-top-width: 2px;
}

#pikksjwbyf .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#pikksjwbyf .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#pikksjwbyf .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#pikksjwbyf .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#pikksjwbyf .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#pikksjwbyf .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#pikksjwbyf .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#pikksjwbyf .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#pikksjwbyf .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#pikksjwbyf .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#pikksjwbyf .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#pikksjwbyf .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#pikksjwbyf .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#pikksjwbyf .gt_left {
  text-align: left;
}

#pikksjwbyf .gt_center {
  text-align: center;
}

#pikksjwbyf .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#pikksjwbyf .gt_font_normal {
  font-weight: normal;
}

#pikksjwbyf .gt_font_bold {
  font-weight: bold;
}

#pikksjwbyf .gt_font_italic {
  font-style: italic;
}

#pikksjwbyf .gt_super {
  font-size: 65%;
}

#pikksjwbyf .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#pikksjwbyf .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#pikksjwbyf .gt_indent_1 {
  text-indent: 5px;
}

#pikksjwbyf .gt_indent_2 {
  text-indent: 10px;
}

#pikksjwbyf .gt_indent_3 {
  text-indent: 15px;
}

#pikksjwbyf .gt_indent_4 {
  text-indent: 20px;
}

#pikksjwbyf .gt_indent_5 {
  text-indent: 25px;
}

#pikksjwbyf .katex-display {
  display: inline-flex !important;
  margin-bottom: 0.75em !important;
}

#pikksjwbyf div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {
  height: 0px !important;
}
</style>

<table class="gt_table caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-quarto-disable-processing="false" data-quarto-bootstrap="false">
<thead>
<tr class="header gt_col_headings">
<th id="var1" class="gt_col_heading gt_columns_bottom_border gt_center" data-quarto-table-cell-role="th" scope="col">var1</th>
<th id="var2" class="gt_col_heading gt_columns_bottom_border gt_left" data-quarto-table-cell-role="th" scope="col">var2</th>
<th id="rho" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">rho</th>
</tr>
</thead>
<tbody class="gt_table_body">
<tr class="odd">
<td class="gt_row gt_center" headers="var1">Qu1</td>
<td class="gt_row gt_left" headers="var2">Qu10</td>
<td class="gt_row gt_right" headers="rho" style="background-color: #9AB1E5; color: #000000">0.5769595</td>
</tr>
<tr class="even">
<td class="gt_row gt_center" headers="var1">Qu2</td>
<td class="gt_row gt_left" headers="var2">Qu19</td>
<td class="gt_row gt_right" headers="rho" style="background-color: #7B9DDD; color: #FFFFFF">0.6807932</td>
</tr>
<tr class="odd">
<td class="gt_row gt_center" headers="var1">Qu3</td>
<td class="gt_row gt_left" headers="var2">Qu13</td>
<td class="gt_row gt_right" headers="rho" style="background-color: #779ADC; color: #FFFFFF">0.6933849</td>
</tr>
<tr class="even">
<td class="gt_row gt_center" headers="var1">Qu4</td>
<td class="gt_row gt_left" headers="var2">Qu3</td>
<td class="gt_row gt_right" headers="rho" style="background-color: #7A9CDD; color: #FFFFFF">0.6833197</td>
</tr>
<tr class="odd">
<td class="gt_row gt_center" headers="var1">Qu5</td>
<td class="gt_row gt_left" headers="var2">Qu12</td>
<td class="gt_row gt_right" headers="rho" style="background-color: #A6BAE8; color: #000000">0.5340169</td>
</tr>
<tr class="even">
<td class="gt_row gt_center" headers="var1">Qu6</td>
<td class="gt_row gt_left" headers="var2">Qu13</td>
<td class="gt_row gt_right" headers="rho" style="background-color: #A0B5E6; color: #000000">0.5558654</td>
</tr>
<tr class="odd">
<td class="gt_row gt_center" headers="var1">Qu7</td>
<td class="gt_row gt_left" headers="var2">Qu8</td>
<td class="gt_row gt_right" headers="rho" style="background-color: #8BA7E1; color: #000000">0.6279136</td>
</tr>
<tr class="even">
<td class="gt_row gt_center" headers="var1">Qu8</td>
<td class="gt_row gt_left" headers="var2">Qu7</td>
<td class="gt_row gt_right" headers="rho" style="background-color: #8BA7E1; color: #000000">0.6279136</td>
</tr>
<tr class="odd">
<td class="gt_row gt_center" headers="var1">Qu9</td>
<td class="gt_row gt_left" headers="var2">Qu10</td>
<td class="gt_row gt_right" headers="rho" style="background-color: #A3B7E7; color: #000000">0.5467141</td>
</tr>
<tr class="even">
<td class="gt_row gt_center" headers="var1">Qu10</td>
<td class="gt_row gt_left" headers="var2">Qu11</td>
<td class="gt_row gt_right" headers="rho" style="background-color: #93ACE3; color: #000000">0.6021983</td>
</tr>
<tr class="odd">
<td class="gt_row gt_center" headers="var1">Qu11</td>
<td class="gt_row gt_left" headers="var2">Qu10</td>
<td class="gt_row gt_right" headers="rho" style="background-color: #93ACE3; color: #000000">0.6021983</td>
</tr>
<tr class="even">
<td class="gt_row gt_center" headers="var1">Qu12</td>
<td class="gt_row gt_left" headers="var2">Qu13</td>
<td class="gt_row gt_right" headers="rho" style="background-color: #8DA8E2; color: #000000">0.6201150</td>
</tr>
<tr class="odd">
<td class="gt_row gt_center" headers="var1">Qu13</td>
<td class="gt_row gt_left" headers="var2">Qu3</td>
<td class="gt_row gt_right" headers="rho" style="background-color: #779ADC; color: #FFFFFF">0.6933849</td>
</tr>
<tr class="even">
<td class="gt_row gt_center" headers="var1">Qu14</td>
<td class="gt_row gt_left" headers="var2">Qu15</td>
<td class="gt_row gt_right" headers="rho" style="background-color: #5186D4; color: #FFFFFF">0.8016290</td>
</tr>
<tr class="odd">
<td class="gt_row gt_center" headers="var1">Qu15</td>
<td class="gt_row gt_left" headers="var2">Qu14</td>
<td class="gt_row gt_right" headers="rho" style="background-color: #5186D4; color: #FFFFFF">0.8016290</td>
</tr>
<tr class="even">
<td class="gt_row gt_center" headers="var1">Qu16</td>
<td class="gt_row gt_left" headers="var2">Qu14</td>
<td class="gt_row gt_right" headers="rho" style="background-color: #98AFE4; color: #000000">0.5850215</td>
</tr>
<tr class="odd">
<td class="gt_row gt_center" headers="var1">Qu17</td>
<td class="gt_row gt_left" headers="var2">Qu18</td>
<td class="gt_row gt_right" headers="rho" style="background-color: #89A6E1; color: #000000">0.6337834</td>
</tr>
<tr class="even">
<td class="gt_row gt_center" headers="var1">Qu18</td>
<td class="gt_row gt_left" headers="var2">Qu17</td>
<td class="gt_row gt_right" headers="rho" style="background-color: #89A6E1; color: #000000">0.6337834</td>
</tr>
<tr class="odd">
<td class="gt_row gt_center" headers="var1">Qu19</td>
<td class="gt_row gt_left" headers="var2">Qu2</td>
<td class="gt_row gt_right" headers="rho" style="background-color: #7B9DDD; color: #FFFFFF">0.6807932</td>
</tr>
<tr class="even">
<td class="gt_row gt_center" headers="var1">Qu20</td>
<td class="gt_row gt_left" headers="var2">Qu21</td>
<td class="gt_row gt_right" headers="rho" style="background-color: #D0D9F3; color: #000000">0.3783280</td>
</tr>
<tr class="odd">
<td class="gt_row gt_center" headers="var1">Qu21</td>
<td class="gt_row gt_left" headers="var2">Qu22</td>
<td class="gt_row gt_right" headers="rho" style="background-color: #799BDD; color: #FFFFFF">0.6890096</td>
</tr>
<tr class="even">
<td class="gt_row gt_center" headers="var1">Qu22</td>
<td class="gt_row gt_left" headers="var2">Qu21</td>
<td class="gt_row gt_right" headers="rho" style="background-color: #799BDD; color: #FFFFFF">0.6890096</td>
</tr>
<tr class="odd">
<td class="gt_row gt_center" headers="var1">Qu23</td>
<td class="gt_row gt_left" headers="var2">Qu24</td>
<td class="gt_row gt_right" headers="rho" style="background-color: #96AEE4; color: #000000">0.5925064</td>
</tr>
<tr class="even">
<td class="gt_row gt_center" headers="var1">Qu24</td>
<td class="gt_row gt_left" headers="var2">Qu25</td>
<td class="gt_row gt_right" headers="rho" style="background-color: #8DA8E2; color: #000000">0.6219807</td>
</tr>
<tr class="odd">
<td class="gt_row gt_center" headers="var1">Qu25</td>
<td class="gt_row gt_left" headers="var2">Qu24</td>
<td class="gt_row gt_right" headers="rho" style="background-color: #8DA8E2; color: #000000">0.6219807</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<ul>
<li>The sample sizes should be large. As a rule of thumb, there should be at least 5 cases per variable.</li>
<li>There should be no outliers. Component scores greater than 3 standard deviations away from the mean can have a disproportionate influence on the results.</li>
</ul>
<section id="sampling-adequacy" class="level4 unnumbered">
<h4 class="unnumbered anchored" data-anchor-id="sampling-adequacy">Sampling Adequacy</h4>
<p>Each variable and the complete model should have an “adequate sample”. The Kaiser-Meyer-Olkin (KMO) measure of sampling adequacy compares the variable’s correlations with other variables to the partial correlations in the data. The test measures sampling adequacy for each variable in the model and for the complete model.<a href="#fn2" class="footnote-ref" id="fnref2" role="doc-noteref"><sup>2</sup></a></p>
<p><span class="math display">\[
\text{KMO}_j = \frac{\sum_{i \ne j}r_{ij}^2}{\sum_{i \ne j}r_{ij}^2 + \sum_{i \ne j} u}
\]</span></p>
<p>where <span class="math inline">\(r_{ij}\)</span> are correlations, and <span class="math inline">\(u_{ij}\)</span> are partial covariances.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a>EFAtools<span class="sc">::</span><span class="fu">KMO</span>(corr_mtrx)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
── Kaiser-Meyer-Olkin criterion (KMO) ──────────────────────────────────────────

✔ The overall KMO value for your data is meritorious.
  These data are probably suitable for factor analysis.

  Overall: 0.833

  For each variable:
  Qu1   Qu2   Qu3   Qu4   Qu5   Qu6   Qu7   Qu8   Qu9  Qu10  Qu11  Qu12  Qu13 
0.817 0.740 0.854 0.889 0.909 0.906 0.843 0.829 0.849 0.762 0.744 0.899 0.857 
 Qu14  Qu15  Qu16  Qu17  Qu18  Qu19  Qu20  Qu21  Qu22  Qu23  Qu24  Qu25 
0.824 0.877 0.913 0.880 0.794 0.803 0.834 0.725 0.724 0.831 0.741 0.803 </code></pre>
</div>
</div>
<p>Scores range from 0 to 1. Values should be at least .6 to justify a PCA. Values over .8 are preferable.</p>
<p>Bartlett’s test of sphericity tests the null hypothesis that the correlation matrix is an identity matrix, i.e., there are no correlations between any variables.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a>EFAtools<span class="sc">::</span><span class="fu">BARTLETT</span>(corr_mtrx, <span class="at">N =</span> <span class="fu">nrow</span>(pca_dat))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
✔ The Bartlett's test of sphericity was significant at an alpha level of .05.
  These data are probably suitable for factor analysis.

  𝜒²(300) = 4214.06, p &lt; .001</code></pre>
</div>
</div>
</section>
</section>
<section id="perform-pca" class="level2" data-number="2.4">
<h2 data-number="2.4" class="anchored" data-anchor-id="perform-pca"><span class="header-section-number">2.4</span> Perform PCA</h2>
<p><code>princomp()</code> from the stats package performs a PCA analysis.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="fu">princomp</span>(pca_numeric,</span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">cor =</span> <span class="cn">TRUE</span></span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a>) <span class="sc">%&gt;%</span> <span class="fu">summary</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Importance of components:
                          Comp.1    Comp.2    Comp.3     Comp.4     Comp.5
Standard deviation     2.5941942 1.8282075 1.7022114 1.42040392 1.02418279
Proportion of Variance 0.2691937 0.1336937 0.1159009 0.08070189 0.04195802
Cumulative Proportion  0.2691937 0.4028875 0.5187884 0.59949029 0.64144831
                           Comp.6     Comp.7     Comp.8     Comp.9    Comp.10
Standard deviation     0.97524654 0.94598379 0.87741458 0.83062128 0.79656944
Proportion of Variance 0.03804423 0.03579541 0.03079425 0.02759727 0.02538092
Cumulative Proportion  0.67949254 0.71528795 0.74608221 0.77367948 0.79906039
                          Comp.11    Comp.12    Comp.13    Comp.14    Comp.15
Standard deviation     0.74070828 0.71685136 0.71025911 0.67117913 0.61776057
Proportion of Variance 0.02194595 0.02055503 0.02017872 0.01801926 0.01526512
Cumulative Proportion  0.82100634 0.84156138 0.86174010 0.87975935 0.89502448
                          Comp.16    Comp.17    Comp.18    Comp.19    Comp.20
Standard deviation     0.60252104 0.59118987 0.56625838 0.54596602 0.53145839
Proportion of Variance 0.01452126 0.01398022 0.01282594 0.01192316 0.01129792
Cumulative Proportion  0.90954574 0.92352596 0.93635190 0.94827506 0.95957298
                          Comp.21     Comp.22     Comp.23     Comp.24
Standard deviation     0.50521683 0.488268586 0.455356970 0.413601318
Proportion of Variance 0.01020976 0.009536248 0.008293999 0.006842642
Cumulative Proportion  0.96978274 0.979318990 0.987612988 0.994455630
                          Comp.25
Standard deviation     0.37230262
Proportion of Variance 0.00554437
Cumulative Proportion  1.00000000</code></pre>
</div>
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a>pca_result <span class="ot">&lt;-</span> <span class="fu">prcomp</span>(pca_numeric, <span class="at">center =</span> <span class="cn">TRUE</span>, <span class="at">scale =</span> <span class="cn">TRUE</span>) </span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a>pca_result<span class="sc">$</span>rotation</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>            PC1        PC2          PC3         PC4          PC5          PC6
Qu1  0.08880021  0.2954028 -0.047700945  0.38373959 -0.032427116 -0.014260804
Qu2  0.20854974 -0.1108258  0.243272200  0.13506570 -0.320699306  0.198246105
Qu3  0.25861637  0.1565354 -0.127503841 -0.18668832 -0.272497353  0.036435804
Qu4  0.26099874  0.1112615 -0.161080505 -0.20185594 -0.120971927 -0.009883049
Qu5  0.22573006  0.1109807 -0.058723134 -0.19418357 -0.041928901 -0.126129537
Qu6  0.25134258  0.1619834 -0.030383602 -0.20407939  0.059995980  0.023136839
Qu7  0.21556137  0.1815289 -0.000593249 -0.15728320  0.411111344  0.146383656
Qu8  0.20310604  0.2049704 -0.106462931 -0.06583315  0.461918578  0.230971681
Qu9  0.12104937  0.3085574  0.071998632  0.27493818 -0.123991470 -0.139412809
Qu10 0.12907306  0.3141529 -0.094845953  0.37638339  0.032982845 -0.086685602
Qu11 0.05908213  0.2621071 -0.086632736  0.43553047 -0.062390478  0.212752432
Qu12 0.25271734  0.1540232 -0.027201710 -0.24116323 -0.139065953 -0.176544132
Qu13 0.24732386  0.1447931 -0.102642975 -0.24407499 -0.200197619 -0.053070906
Qu14 0.25030942 -0.1615502  0.260934958  0.04561108 -0.243698948  0.046775295
Qu15 0.25742291 -0.1820475  0.238057822  0.04367017 -0.119723406 -0.014958661
Qu16 0.23931180 -0.1322652  0.204766302  0.04972096  0.198859729 -0.128203472
Qu17 0.21634317 -0.2193739  0.205146483  0.06003951  0.154521945  0.079568880
Qu18 0.23785222 -0.1580100  0.208470731  0.07736676  0.284807751 -0.084274627
Qu19 0.22311526 -0.1013021  0.277760611  0.15574391  0.010207245  0.102321892
Qu20 0.13757098 -0.1252275 -0.196534814  0.06259393  0.161085114  0.443149010
Qu21 0.09399022 -0.2499783 -0.342342961  0.03050748 -0.104406723  0.375433724
Qu22 0.10373111 -0.2175458 -0.339886515  0.09312080 -0.222143718  0.252660854
Qu23 0.19476243 -0.1671902 -0.247980501  0.19363269 -0.004035236 -0.375053636
Qu24 0.09765723 -0.2725999 -0.336330097  0.09768936  0.067779814 -0.317003018
Qu25 0.16307914 -0.2343393 -0.268940287  0.15791595  0.174721718 -0.276722503
              PC7           PC8          PC9         PC10        PC11
Qu1  -0.050252194  0.2595443744 -0.036016906 -0.105889108  0.06788776
Qu2   0.158814932 -0.4656984641  0.003342182  0.062173186 -0.18917563
Qu3  -0.141256040  0.2240084667 -0.119877235  0.177345090  0.05033921
Qu4  -0.004507417 -0.1022041173  0.004284583  0.100370513  0.14732036
Qu5  -0.244874568 -0.0939369203  0.146156341 -0.757718031 -0.17110249
Qu6  -0.067604137 -0.1923949237  0.407988955  0.052310635  0.09637982
Qu7   0.373076199  0.1088715966  0.036897821  0.005413643 -0.11602737
Qu8   0.288276062 -0.1004906456  0.018703496  0.136946621 -0.10536603
Qu9   0.131626314 -0.0009666394 -0.155171174 -0.038447007  0.55706355
Qu10 -0.074118220 -0.1019170728  0.201295893  0.082064014 -0.01840620
Qu11 -0.120395473  0.1260946372 -0.015370131 -0.046720010 -0.47548098
Qu12  0.094477262 -0.0298586876 -0.286888020 -0.121999525 -0.15617144
Qu13 -0.164373569  0.1148512227 -0.226931563  0.278238788 -0.03567092
Qu14  0.113687796  0.1507216523  0.242494509  0.143476208 -0.08146459
Qu15  0.064827854  0.2583534187  0.091183951  0.175473420 -0.17761641
Qu16 -0.109348606  0.1088784933  0.350956898 -0.037444805  0.36955179
Qu17 -0.219685429  0.2886617364  0.041629462 -0.097711376 -0.11722763
Qu18 -0.059260178  0.2119620948 -0.421876994 -0.092472661  0.07835393
Qu19  0.051507950 -0.4225233656 -0.285959987 -0.165305087  0.09935633
Qu20 -0.588147099 -0.2176722492 -0.053675442  0.183169135  0.15494774
Qu21  0.162351807  0.1682814722 -0.044764442 -0.258714379  0.16535061
Qu22  0.335822638  0.1342529954  0.079765273 -0.160346225  0.16315611
Qu23  0.112425899 -0.1544232548  0.202782100  0.071849766 -0.05502823
Qu24 -0.090111417 -0.0054837983  0.066510800  0.100542130 -0.13008011
Qu25  0.053615520 -0.1458654003 -0.295923786  0.073311736 -0.08608091
             PC12        PC13        PC14         PC15        PC16         PC17
Qu1   0.444213763  0.01383998  0.50845562 -0.282860774  0.06718768 -0.025161779
Qu2   0.130911352 -0.01275331  0.03824848 -0.199576469  0.07462857  0.130903899
Qu3   0.173367533  0.21268867 -0.11777959  0.158069295  0.07687026  0.018002830
Qu4   0.505101907  0.10433672 -0.38240273  0.187959292  0.06930758  0.112348338
Qu5  -0.002987834 -0.06814112 -0.07355470  0.134896760  0.04569195 -0.118796412
Qu6  -0.334802552  0.30690233  0.12499905 -0.223406056  0.11151021 -0.256071742
Qu7  -0.116569822 -0.29350249 -0.15534374 -0.054478574 -0.14805555  0.399547955
Qu8   0.211327527  0.03483738  0.11855610  0.058896787  0.25529530 -0.327851585
Qu9  -0.235901940 -0.35842761 -0.29354062  0.001228295  0.24080467 -0.128054985
Qu10 -0.179562924  0.14807806 -0.13920109 -0.068600835 -0.29441151 -0.109935027
Qu11 -0.180307022  0.07704212 -0.12217718  0.311463807  0.10111892  0.248007878
Qu12 -0.063774810 -0.31539306  0.32621603 -0.029196835 -0.17960807 -0.023572277
Qu13 -0.302345576  0.08550484  0.14190190 -0.266383750 -0.04784932  0.257061507
Qu14 -0.036354537 -0.15193628  0.03434910  0.195431260  0.05553188 -0.194444918
Qu15 -0.059642059 -0.16429322  0.05400804  0.225096187 -0.04530071 -0.304327454
Qu16  0.003923788  0.10142198  0.30440544  0.297038558  0.01795693  0.487137698
Qu17  0.082704529  0.04166032 -0.37247439 -0.554750467  0.14419833  0.052653323
Qu18 -0.026388993  0.21621834 -0.07597895  0.035695308 -0.23561987 -0.236742598
Qu19 -0.018336124  0.12333912  0.05556522 -0.006502254  0.08883386  0.157370327
Qu20 -0.007657944 -0.36384567  0.06690138  0.080579391 -0.19180427 -0.093202842
Qu21 -0.047501076 -0.05841413  0.08642856  0.003648458 -0.02337067 -0.013779143
Qu22 -0.158509430  0.20851929 -0.01047479 -0.095040066 -0.08813706  0.007389185
Qu23  0.224023915 -0.12802651 -0.11514322 -0.118703484 -0.49423214  0.001861678
Qu24 -0.053654064 -0.29716844  0.03298947 -0.115325567  0.53914379  0.071271792
Qu25 -0.144384076  0.29356245  0.05386909  0.206597842  0.13580258 -0.022801313
            PC18        PC19        PC20         PC21        PC22         PC23
Qu1   0.08458968 -0.18531614  0.23360269 -0.159717066  0.02749887  0.044843566
Qu2  -0.08247300 -0.05054969  0.14733367  0.272405639 -0.12507316  0.163648302
Qu3   0.16098042  0.32192437 -0.20323946 -0.243342078 -0.18250840  0.458467846
Qu4  -0.15251342 -0.28811291  0.11533771 -0.037045153  0.02392183 -0.439023293
Qu5   0.23455219  0.03611104  0.20041748  0.179446059  0.04681173  0.085176013
Qu6  -0.35424540 -0.11891570  0.08570051 -0.357745491  0.10054293  0.068678060
Qu7   0.17392894 -0.13197635  0.25704854 -0.273923940 -0.11854638  0.140997153
Qu8   0.05428100  0.25652788 -0.19103490  0.378429635  0.13592991  0.004740116
Qu9  -0.11238810 -0.04110671  0.01277715  0.138960909  0.11384872  0.165720046
Qu10  0.26004089  0.09156121 -0.11591902  0.087566930 -0.52416595 -0.331811580
Qu11 -0.31841353  0.02033103 -0.09067531 -0.049695046  0.28046335 -0.004495437
Qu12 -0.21789851 -0.19793117 -0.55112807 -0.049350141 -0.10414353 -0.141601971
Qu13  0.11189232  0.16615063  0.30076909  0.370651654  0.18186063 -0.131334040
Qu14  0.25292400 -0.07833185 -0.01341317 -0.061613902 -0.07183158  0.122777037
Qu15 -0.05439073 -0.04818029  0.22581976 -0.018930982  0.03899214 -0.233664609
Qu16 -0.08542880  0.04004784 -0.18028298  0.236465433 -0.01430013 -0.019592299
Qu17 -0.08831301 -0.15165706 -0.30578177  0.120289684 -0.07507636  0.067278739
Qu18 -0.08917553  0.13682402  0.15490323 -0.055027823  0.11551257 -0.117606706
Qu19  0.16496140  0.28415751 -0.07231158 -0.397009319  0.07350360 -0.172153412
Qu20  0.11649387 -0.16475730 -0.02361433 -0.034437969  0.08762449  0.076542877
Qu21 -0.41683445  0.25587626  0.17950574  0.055157562 -0.42902165 -0.032984130
Qu22  0.36534303 -0.19481178 -0.23700709  0.001264521  0.37692796 -0.135726171
Qu23 -0.17770941  0.25689845  0.00379383 -0.009741968  0.28812177  0.251093193
Qu24  0.10258052  0.22866970  0.01214450 -0.202134745 -0.03143182 -0.250668830
Qu25  0.03788034 -0.46812025  0.08654309  0.107880397 -0.21334653  0.303669189
             PC24        PC25
Qu1  -0.018018271  0.03445683
Qu2   0.205218787 -0.41446630
Qu3  -0.083196283 -0.25010793
Qu4   0.071853785  0.10673570
Qu5  -0.034471006 -0.02373962
Qu6   0.057225253 -0.03055766
Qu7   0.012856463 -0.09078891
Qu8  -0.046721000  0.07578996
Qu9  -0.042673960 -0.02529162
Qu10  0.012161984 -0.05280348
Qu11  0.082720670  0.04933669
Qu12  0.059365119 -0.02699995
Qu13 -0.038304099  0.23772914
Qu14  0.424303963  0.52802669
Qu15 -0.570217652 -0.26296699
Qu16  0.007962932 -0.11448371
Qu17 -0.168275070  0.12917277
Qu18  0.483138136 -0.24358737
Qu19 -0.292926331  0.29127792
Qu20  0.010850892 -0.04217937
Qu21 -0.022321501  0.18362885
Qu22  0.016761570 -0.20270922
Qu23 -0.080072024  0.14245451
Qu24  0.203143393 -0.19637309
Qu25 -0.153283522  0.13082350</code></pre>
</div>
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="fu">biplot</span>(pca_result, <span class="at">scale =</span> <span class="dv">0</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="02-pca_files/figure-html/unnamed-chunk-22-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a>pca_result<span class="sc">$</span>sdev<span class="sc">^</span><span class="dv">2</span> <span class="sc">/</span> <span class="fu">sum</span>(pca_result<span class="sc">$</span>sdev<span class="sc">^</span><span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] 0.269193743 0.133693712 0.115900948 0.080701891 0.041958016 0.038044232
 [7] 0.035795413 0.030794254 0.027597268 0.025380915 0.021945950 0.020555035
[13] 0.020178720 0.018019257 0.015265125 0.014521264 0.013980218 0.012825942
[19] 0.011923156 0.011297921 0.010209762 0.009536248 0.008293999 0.006842642
[25] 0.005544370</code></pre>
</div>
</div>
<p>The communality is the proportion of each variable’s variance that is accounted for by the principal components analysis and can also be expressed as a percentage.</p>
<p>A principal components analysis will produce as many components as there are variables. However, the purpose of principal components analysis is to explain as much of the variance in your variables as possible using as few components as possible. After you have extracted your components, there are four major criteria that can help you decide on the number of components to retain: (a) the eigenvalue-one criterion, (b) the proportion of total variance accounted for, (c) the scree plot test, and (d) the interpretability criterion. All except for the first criterion will require some degree of subjective analysis.</p>
</section>
<section id="appendix-eigenvectors" class="level2" data-number="2.5">
<h2 data-number="2.5" class="anchored" data-anchor-id="appendix-eigenvectors"><span class="header-section-number">2.5</span> Appendix: Eigenvectors</h2>
<p>A square matrix, <span class="math inline">\(\textbf{A}\)</span>, can be decomposed into eigenvalues, <span class="math inline">\(\lambda\)</span>, and eigenvectors, <span class="math inline">\(\textbf{v}\)</span>.<a href="#fn3" class="footnote-ref" id="fnref3" role="doc-noteref"><sup>3</sup></a></p>
<p><span id="eq-eigen1"><span class="math display">\[
\textbf{A} \textbf{v} = \lambda \textbf{v}
\tag{2.1}\]</span></span></p>
<p>For example, <span class="math inline">\(6\)</span> and <span class="math inline">\(\begin{bmatrix}1 \\ 4 \end{bmatrix}\)</span> are an eigenvalue and eigenvector here:</p>
<p><span class="math display">\[
\begin{bmatrix} -6 &amp; 3 \\ 4 &amp; 5 \end{bmatrix} \begin{bmatrix}1 \\ 4 \end{bmatrix} = 6 \begin{bmatrix}1 \\ 4 \end{bmatrix}
\]</span></p>
<p><a href="#eq-eigen1" class="quarto-xref">Equation&nbsp;<span>2.1</span></a> can be re-expressed as <span class="math inline">\(\textbf{A} \textbf{v} - \lambda \textbf{I} \textbf{v} = 0.\)</span> For <span class="math inline">\(\textbf{v}\)</span> to be non-zero, the determinant must be zero,</p>
<p><span id="eq-eigen2"><span class="math display">\[
| \textbf{A} - \lambda \textbf{I}| = 0
\tag{2.2}\]</span></span></p>
<p>Back to the example, use <a href="#eq-eigen2" class="quarto-xref">Equation&nbsp;<span>2.2</span></a> to find possible eigenvalues.</p>
<p><span class="math display">\[
\left| \begin{bmatrix} -6 &amp; 3 \\ 4 &amp; 5 \end{bmatrix} - \lambda \begin{bmatrix} 1 &amp; 0 \\ 0 &amp; 1 \end{bmatrix} \right| = 0
\]</span></p>
<p>Subtract the matrices and calculate the determinant, <span class="math inline">\((-6 - \lambda)(5 - \lambda) - 3 \times 4 = 0,\)</span> then solve for <span class="math inline">\(\lambda = -7 \text{ or } 6.\)</span> Now that you have the possible eigenvalues, plug them back into Equation @ref(eq:eigen1). For <span class="math inline">\(\lambda = 6\)</span> you have</p>
<p><span class="math display">\[
\begin{bmatrix} -6 &amp; 3 \\ 4 &amp; 5 \end{bmatrix} \begin{bmatrix}x \\ y \end{bmatrix} = 6 \begin{bmatrix}x \\ y \end{bmatrix}
\]</span></p>
<p>Solving the system of equations reveals that <span class="math inline">\(y = 4x\)</span>. So <span class="math inline">\(\begin{bmatrix}1 \\ 4 \end{bmatrix}\)</span> is a solution. You can do the same exercise for <span class="math inline">\(\lambda = -7\)</span>.</p>
<p>Eigenvectors and eigenvalues are useful because matrices are used to make transformations in space. In transformations, the eigenvector is the axis of rotation, the direction that does not change, and the eigenvalue is the scale of the stretch (1 = no change, 2 = double length, -1 = point backwards, etc.).</p>


<!-- -->

<div id="refs" class="references csl-bib-body hanging-indent" data-entry-spacing="0" role="list" style="display: none">
<div id="ref-shlens2014tutorial" class="csl-entry" role="listitem">
Shlens, Jonathon. 2014. <span>“A Tutorial on Principal Component Analysis.”</span> <em>arXiv Preprint arXiv:1404.1100</em>. <a href="https://arxiv.org/abs/1404.1100">https://arxiv.org/abs/1404.1100</a>.
</div>
</div>
</section>
<section id="footnotes" class="footnotes footnotes-end-of-document" role="doc-endnotes">
<hr>
<ol>
<li id="fn1"><p>Material from <a href="https://online.stat.psu.edu/stat505/lesson/11">PSU</a>, <a href="https://statistics.laerd.com/premium/spss/pca/pca-in-spss.php">Laerd</a>, and <span class="citation" data-cites="shlens2014tutorial">Shlens (<a href="03-references.html#ref-shlens2014tutorial" role="doc-biblioref">2014</a>)</span>.<a href="#fnref1" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn2"><p>See <a href="https://www.statisticshowto.com/kaiser-meyer-olkin/">Statistics How-to</a>.<a href="#fnref2" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn3"><p>Took these notes from <a href="https://www.mathsisfun.com/algebra/eigenvalue.html">Math is Fun</a>.<a href="#fnref3" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
</ol>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    // For code content inside modals, clipBoardJS needs to be initialized with a container option
    // TODO: Check when it could be a function (https://github.com/zenorocha/clipboard.js/issues/860)
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
  const viewSource = window.document.getElementById('quarto-view-source') ||
                     window.document.getElementById('quarto-code-tools-source');
  if (viewSource) {
    const sourceUrl = viewSource.getAttribute("data-quarto-source-url");
    viewSource.addEventListener("click", function(e) {
      if (sourceUrl) {
        // rstudio viewer pane
        if (/\bcapabilities=\b/.test(window.location)) {
          window.open(sourceUrl);
        } else {
          window.location.href = sourceUrl;
        }
      } else {
        const modal = new bootstrap.Modal(document.getElementById('quarto-embedded-source-code-modal'));
        modal.show();
      }
      return false;
    });
  }
  function toggleCodeHandler(show) {
    return function(e) {
      const detailsSrc = window.document.querySelectorAll(".cell > details > .sourceCode");
      for (let i=0; i<detailsSrc.length; i++) {
        const details = detailsSrc[i].parentElement;
        if (show) {
          details.open = true;
        } else {
          details.removeAttribute("open");
        }
      }
      const cellCodeDivs = window.document.querySelectorAll(".cell > .sourceCode");
      const fromCls = show ? "hidden" : "unhidden";
      const toCls = show ? "unhidden" : "hidden";
      for (let i=0; i<cellCodeDivs.length; i++) {
        const codeDiv = cellCodeDivs[i];
        if (codeDiv.classList.contains(fromCls)) {
          codeDiv.classList.remove(fromCls);
          codeDiv.classList.add(toCls);
        } 
      }
      return false;
    }
  }
  const hideAllCode = window.document.getElementById("quarto-hide-all-code");
  if (hideAllCode) {
    hideAllCode.addEventListener("click", toggleCodeHandler(false));
  }
  const showAllCode = window.document.getElementById("quarto-show-all-code");
  if (showAllCode) {
    showAllCode.addEventListener("click", toggleCodeHandler(true));
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./01-cluster-analysis.html" class="pagination-link" aria-label="Cluster Analysis">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Cluster Analysis</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./03-references.html" class="pagination-link" aria-label="References">
        <span class="nav-page-text">References</span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav><div class="modal fade" id="quarto-embedded-source-code-modal" tabindex="-1" aria-labelledby="quarto-embedded-source-code-modal-label" aria-hidden="true"><div class="modal-dialog modal-dialog-scrollable"><div class="modal-content"><div class="modal-header"><h5 class="modal-title" id="quarto-embedded-source-code-modal-label">Source Code</h5><button class="btn-close" data-bs-dismiss="modal"></button></div><div class="modal-body"><div class="">
<div class="sourceCode" id="cb33" data-shortcodes="false"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a><span class="fu"># PCA {#sec-pca}</span></span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-3"><a href="#cb33-3" aria-hidden="true" tabindex="-1"></a>Machine learning datasets often have an enormous number of columns, many of which are correlated because they essentially measure the same latent construct. You could drop redundant columns, but sometimes the redundancy is not obvious, hidden in combinations of columns. Principle components analysis (PCA) reduces the number of columns to a few, interpretable linear combinations while retaining as much information as possible.^<span class="co">[</span><span class="ot">Material from [PSU](https://online.stat.psu.edu/stat505/lesson/11), [Laerd](https://statistics.laerd.com/premium/spss/pca/pca-in-spss.php), and @shlens2014tutorial.</span><span class="co">]</span></span>
<span id="cb33-4"><a href="#cb33-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-5"><a href="#cb33-5" aria-hidden="true" tabindex="-1"></a>No special packages for this section, just load the tidyverse.</span>
<span id="cb33-6"><a href="#cb33-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-9"><a href="#cb33-9" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb33-10"><a href="#cb33-10" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb33-11"><a href="#cb33-11" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb33-12"><a href="#cb33-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-13"><a href="#cb33-13" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb33-14"><a href="#cb33-14" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb33-15"><a href="#cb33-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-16"><a href="#cb33-16" aria-hidden="true" tabindex="-1"></a><span class="fu">## Intuition and Matrix Algebra</span></span>
<span id="cb33-17"><a href="#cb33-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-18"><a href="#cb33-18" aria-hidden="true" tabindex="-1"></a>@shlens2014tutorial introduces PCA with an intuitive toy example where the movement of an oscillating spring is monitored by cameras from three positions in a room. Each camera produces a dataset of x and y coordinates, six vectors of numbers altogether, but the physical reality is there is only one dimension of movement. PCA should be able to reduce the six vectors into a single principle component.</span>
<span id="cb33-19"><a href="#cb33-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-20"><a href="#cb33-20" aria-hidden="true" tabindex="-1"></a>I'll simplify this even more. The three cameras are all located at x = 0, y = 0, but are rotated 15 degrees, 45 degrees, and 150 degrees respectively. From the cameras' perspectives, the oscillation occurs in different directions.</span>
<span id="cb33-21"><a href="#cb33-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-24"><a href="#cb33-24" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb33-25"><a href="#cb33-25" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb33-26"><a href="#cb33-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-27"><a href="#cb33-27" aria-hidden="true" tabindex="-1"></a><span class="co"># 100 photos of the end of the spring taken over 10s of motion.</span></span>
<span id="cb33-28"><a href="#cb33-28" aria-hidden="true" tabindex="-1"></a>t <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">10</span>, <span class="at">length.out =</span> <span class="dv">100</span>)</span>
<span id="cb33-29"><a href="#cb33-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-30"><a href="#cb33-30" aria-hidden="true" tabindex="-1"></a><span class="co"># simple harmonic motion from our perspective: 0-degree rotation.</span></span>
<span id="cb33-31"><a href="#cb33-31" aria-hidden="true" tabindex="-1"></a>x_0 <span class="ot">&lt;-</span> <span class="fu">sin</span>(<span class="dv">2</span> <span class="sc">*</span> pi <span class="sc">*</span> <span class="fl">0.5</span> <span class="sc">*</span> t)</span>
<span id="cb33-32"><a href="#cb33-32" aria-hidden="true" tabindex="-1"></a>y_0 <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="dv">0</span>, <span class="fu">length</span>(t))</span>
<span id="cb33-33"><a href="#cb33-33" aria-hidden="true" tabindex="-1"></a>coords_0 <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">c</span>(x_0, y_0), <span class="at">ncol =</span> <span class="dv">2</span>)</span>
<span id="cb33-34"><a href="#cb33-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-35"><a href="#cb33-35" aria-hidden="true" tabindex="-1"></a><span class="co"># 15-degree rotation matrix for camera 1</span></span>
<span id="cb33-36"><a href="#cb33-36" aria-hidden="true" tabindex="-1"></a>theta_1 <span class="ot">=</span> pi <span class="sc">*</span> (<span class="dv">1</span> <span class="sc">/</span> <span class="dv">12</span>)</span>
<span id="cb33-37"><a href="#cb33-37" aria-hidden="true" tabindex="-1"></a>M_1 <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">c</span>(<span class="fu">cos</span>(theta_1), <span class="sc">-</span><span class="fu">sin</span>(theta_1), <span class="fu">sin</span>(theta_1), <span class="fu">cos</span>(theta_1)), <span class="at">nrow =</span> <span class="dv">2</span>)</span>
<span id="cb33-38"><a href="#cb33-38" aria-hidden="true" tabindex="-1"></a>coords_1 <span class="ot">&lt;-</span> coords_0 <span class="sc">%*%</span> M_1</span>
<span id="cb33-39"><a href="#cb33-39" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-40"><a href="#cb33-40" aria-hidden="true" tabindex="-1"></a><span class="co"># 45-degree rotation matrix for camera 2</span></span>
<span id="cb33-41"><a href="#cb33-41" aria-hidden="true" tabindex="-1"></a>theta_2 <span class="ot">=</span> pi <span class="sc">*</span> (<span class="dv">1</span> <span class="sc">/</span> <span class="dv">4</span>)</span>
<span id="cb33-42"><a href="#cb33-42" aria-hidden="true" tabindex="-1"></a>M_2 <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">c</span>(<span class="fu">cos</span>(theta_2), <span class="sc">-</span><span class="fu">sin</span>(theta_2), <span class="fu">sin</span>(theta_2), <span class="fu">cos</span>(theta_2)), <span class="at">nrow =</span> <span class="dv">2</span>)</span>
<span id="cb33-43"><a href="#cb33-43" aria-hidden="true" tabindex="-1"></a>coords_2 <span class="ot">&lt;-</span> coords_0 <span class="sc">%*%</span> M_2</span>
<span id="cb33-44"><a href="#cb33-44" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-45"><a href="#cb33-45" aria-hidden="true" tabindex="-1"></a><span class="co"># 150-degree rotation matrix for camera 3</span></span>
<span id="cb33-46"><a href="#cb33-46" aria-hidden="true" tabindex="-1"></a>theta_3 <span class="ot">=</span> pi <span class="sc">*</span> (<span class="dv">5</span> <span class="sc">/</span> <span class="dv">6</span>)</span>
<span id="cb33-47"><a href="#cb33-47" aria-hidden="true" tabindex="-1"></a>M_3 <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">c</span>(<span class="fu">cos</span>(theta_3), <span class="sc">-</span><span class="fu">sin</span>(theta_3), <span class="fu">sin</span>(theta_3), <span class="fu">cos</span>(theta_3)), <span class="at">nrow =</span> <span class="dv">2</span>)</span>
<span id="cb33-48"><a href="#cb33-48" aria-hidden="true" tabindex="-1"></a>coords_3 <span class="ot">&lt;-</span> coords_0 <span class="sc">%*%</span> M_3</span>
<span id="cb33-49"><a href="#cb33-49" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-50"><a href="#cb33-50" aria-hidden="true" tabindex="-1"></a><span class="co"># Combined dataset</span></span>
<span id="cb33-51"><a href="#cb33-51" aria-hidden="true" tabindex="-1"></a>spring <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb33-52"><a href="#cb33-52" aria-hidden="true" tabindex="-1"></a>  <span class="at">camera_1_x =</span> coords_1[, <span class="dv">1</span>],</span>
<span id="cb33-53"><a href="#cb33-53" aria-hidden="true" tabindex="-1"></a>  <span class="at">camera_1_y =</span> coords_1[, <span class="dv">2</span>],</span>
<span id="cb33-54"><a href="#cb33-54" aria-hidden="true" tabindex="-1"></a>  <span class="at">camera_2_x =</span> coords_2[, <span class="dv">1</span>],</span>
<span id="cb33-55"><a href="#cb33-55" aria-hidden="true" tabindex="-1"></a>  <span class="at">camera_2_y =</span> coords_2[, <span class="dv">2</span>],</span>
<span id="cb33-56"><a href="#cb33-56" aria-hidden="true" tabindex="-1"></a>  <span class="at">camera_3_x =</span> coords_3[, <span class="dv">1</span>],</span>
<span id="cb33-57"><a href="#cb33-57" aria-hidden="true" tabindex="-1"></a>  <span class="at">camera_3_y =</span> coords_3[, <span class="dv">2</span>]</span>
<span id="cb33-58"><a href="#cb33-58" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb33-59"><a href="#cb33-59" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb33-60"><a href="#cb33-60" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-63"><a href="#cb33-63" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb33-64"><a href="#cb33-64" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb33-65"><a href="#cb33-65" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-66"><a href="#cb33-66" aria-hidden="true" tabindex="-1"></a>spring <span class="sc">|&gt;</span></span>
<span id="cb33-67"><a href="#cb33-67" aria-hidden="true" tabindex="-1"></a>  <span class="co"># pivot_longer(</span></span>
<span id="cb33-68"><a href="#cb33-68" aria-hidden="true" tabindex="-1"></a>  <span class="co">#   everything(</span></span>
<span id="cb33-69"><a href="#cb33-69" aria-hidden="true" tabindex="-1"></a>  <span class="co">#     names_to = c("")</span></span>
<span id="cb33-70"><a href="#cb33-70" aria-hidden="true" tabindex="-1"></a>  <span class="co">#   )</span></span>
<span id="cb33-71"><a href="#cb33-71" aria-hidden="true" tabindex="-1"></a>  <span class="co"># )</span></span>
<span id="cb33-72"><a href="#cb33-72" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(</span>
<span id="cb33-73"><a href="#cb33-73" aria-hidden="true" tabindex="-1"></a>    <span class="fu">everything</span>(), </span>
<span id="cb33-74"><a href="#cb33-74" aria-hidden="true" tabindex="-1"></a>    <span class="at">names_to =</span> <span class="fu">c</span>(<span class="st">"Camera"</span>, <span class="st">"Coord"</span>),</span>
<span id="cb33-75"><a href="#cb33-75" aria-hidden="true" tabindex="-1"></a>    <span class="at">names_pattern =</span> <span class="st">"camera_(.)_(.)"</span></span>
<span id="cb33-76"><a href="#cb33-76" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span></span>
<span id="cb33-77"><a href="#cb33-77" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb33-78"><a href="#cb33-78" aria-hidden="true" tabindex="-1"></a>    <span class="at">Camera =</span> <span class="fu">case_when</span>(</span>
<span id="cb33-79"><a href="#cb33-79" aria-hidden="true" tabindex="-1"></a>      Camera <span class="sc">==</span> <span class="st">"1"</span> <span class="sc">~</span> <span class="st">"Camera 1 (15-degrees)"</span>,</span>
<span id="cb33-80"><a href="#cb33-80" aria-hidden="true" tabindex="-1"></a>      Camera <span class="sc">==</span> <span class="st">"2"</span> <span class="sc">~</span> <span class="st">"Camera 2 (45-degrees)"</span>,</span>
<span id="cb33-81"><a href="#cb33-81" aria-hidden="true" tabindex="-1"></a>      Camera <span class="sc">==</span> <span class="st">"3"</span> <span class="sc">~</span> <span class="st">"Camera 3 (150-degrees)"</span></span>
<span id="cb33-82"><a href="#cb33-82" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb33-83"><a href="#cb33-83" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span></span>
<span id="cb33-84"><a href="#cb33-84" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">.by =</span> <span class="fu">c</span>(Camera, Coord), <span class="at">Obs =</span> <span class="fu">row_number</span>()) <span class="sc">|&gt;</span></span>
<span id="cb33-85"><a href="#cb33-85" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_wider</span>(<span class="at">names_from =</span> Coord, <span class="at">values_from =</span> value) <span class="sc">|&gt;</span></span>
<span id="cb33-86"><a href="#cb33-86" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> y)) <span class="sc">+</span></span>
<span id="cb33-87"><a href="#cb33-87" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb33-88"><a href="#cb33-88" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="fu">vars</span>(Camera), <span class="at">nrow =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb33-89"><a href="#cb33-89" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Simple Harmonic Motion from Three Perspectives"</span>)</span>
<span id="cb33-90"><a href="#cb33-90" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb33-91"><a href="#cb33-91" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-94"><a href="#cb33-94" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb33-95"><a href="#cb33-95" aria-hidden="true" tabindex="-1"></a>pca <span class="ot">&lt;-</span> <span class="fu">prcomp</span>(spring, <span class="at">center =</span> <span class="cn">TRUE</span>, <span class="at">scale. =</span> <span class="cn">TRUE</span>)</span>
<span id="cb33-96"><a href="#cb33-96" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-97"><a href="#cb33-97" aria-hidden="true" tabindex="-1"></a><span class="co"># Summary of PCA</span></span>
<span id="cb33-98"><a href="#cb33-98" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(pca)</span>
<span id="cb33-99"><a href="#cb33-99" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-100"><a href="#cb33-100" aria-hidden="true" tabindex="-1"></a><span class="co"># Biplot of PCA</span></span>
<span id="cb33-101"><a href="#cb33-101" aria-hidden="true" tabindex="-1"></a><span class="fu">biplot</span>(pca)</span>
<span id="cb33-102"><a href="#cb33-102" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-103"><a href="#cb33-103" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb33-104"><a href="#cb33-104" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-105"><a href="#cb33-105" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-106"><a href="#cb33-106" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-107"><a href="#cb33-107" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-108"><a href="#cb33-108" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-109"><a href="#cb33-109" aria-hidden="true" tabindex="-1"></a>cameras set up along three axes $<span class="sc">\{</span> \vec{a}, \vec{b}, \vec{c} <span class="sc">\}</span>$. That's more dimensional data than you need! PCA reveals the hidden structure in your noisy data: $\vec{x}$ is the important dimension.</span>
<span id="cb33-110"><a href="#cb33-110" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-111"><a href="#cb33-111" aria-hidden="true" tabindex="-1"></a>Your dataset consists of 72,000 rows photos: 120 photos taken per second for 10 minutes The columns are the x- and y- coordinates measured from each camera. Each row of data may be expressed as a column vector, $\vec{X}$.</span>
<span id="cb33-112"><a href="#cb33-112" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-113"><a href="#cb33-113" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb33-114"><a href="#cb33-114" aria-hidden="true" tabindex="-1"></a>\vec{X} = \begin{bmatrix} x_A <span class="sc">\\</span> y_A <span class="sc">\\</span> x_B <span class="sc">\\</span> y_B <span class="sc">\\</span> x_C <span class="sc">\\</span> y_C \end{bmatrix}</span>
<span id="cb33-115"><a href="#cb33-115" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb33-116"><a href="#cb33-116" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-117"><a href="#cb33-117" aria-hidden="true" tabindex="-1"></a>$\vec{X}$ is an *m = 6*-dimensional vector. Equivalently, $\vec{X}$ lies in an *m*-dimensional vector space spanned by some orthonormal basis. The orthonormal basis for each camera is $<span class="sc">\{</span>(1,0), (0,1)<span class="sc">\}</span>$ _from its own perspective_, so a data point from camera $A$ might equivalently be expressed as </span>
<span id="cb33-118"><a href="#cb33-118" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-119"><a href="#cb33-119" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb33-120"><a href="#cb33-120" aria-hidden="true" tabindex="-1"></a>\begin{bmatrix} 1 &amp; 0 <span class="sc">\\</span> 0 &amp; 1 \end{bmatrix} \begin{bmatrix} x_A <span class="sc">\\</span> y_A \end{bmatrix}</span>
<span id="cb33-121"><a href="#cb33-121" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb33-122"><a href="#cb33-122" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-123"><a href="#cb33-123" aria-hidden="true" tabindex="-1"></a>::: {.callout-tip collapse="true"}</span>
<span id="cb33-124"><a href="#cb33-124" aria-hidden="true" tabindex="-1"></a><span class="fu">## Note on Orthonormal Bases</span></span>
<span id="cb33-125"><a href="#cb33-125" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-126"><a href="#cb33-126" aria-hidden="true" tabindex="-1"></a>An orthonormal basis is any set of vectors whose pairwise inner products are zero. The orthonormal basis for camera $A$ might be $<span class="sc">\{</span>(\sqrt{2}/2,\sqrt{2}/2), (-\sqrt{2}/2,\sqrt{2}/2)<span class="sc">\}</span>$ from a neutral perspective. From the neutral perspective, you would have to rotate the axes 45 degrees.</span>
<span id="cb33-127"><a href="#cb33-127" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-130"><a href="#cb33-130" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb33-131"><a href="#cb33-131" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-height: 3</span></span>
<span id="cb33-132"><a href="#cb33-132" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-width: 5</span></span>
<span id="cb33-133"><a href="#cb33-133" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-134"><a href="#cb33-134" aria-hidden="true" tabindex="-1"></a><span class="co"># M is a 45-degree line</span></span>
<span id="cb33-135"><a href="#cb33-135" aria-hidden="true" tabindex="-1"></a>M <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">c</span>(<span class="dv">0</span><span class="sc">:</span><span class="dv">100</span>, <span class="dv">0</span><span class="sc">:</span><span class="dv">100</span> <span class="sc">*</span> <span class="fu">tan</span>(<span class="dv">45</span><span class="sc">*</span>(pi<span class="sc">/</span><span class="dv">180</span>))), <span class="at">ncol =</span> <span class="dv">2</span>)</span>
<span id="cb33-136"><a href="#cb33-136" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(M) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"X"</span>, <span class="st">"Y"</span>)</span>
<span id="cb33-137"><a href="#cb33-137" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-138"><a href="#cb33-138" aria-hidden="true" tabindex="-1"></a><span class="co"># M is unchanged after multiplication by identity matrix.</span></span>
<span id="cb33-139"><a href="#cb33-139" aria-hidden="true" tabindex="-1"></a>I <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">1</span>), <span class="at">nrow =</span> <span class="dv">2</span>)</span>
<span id="cb33-140"><a href="#cb33-140" aria-hidden="true" tabindex="-1"></a>M1 <span class="ot">&lt;-</span> M <span class="sc">%*%</span> I</span>
<span id="cb33-141"><a href="#cb33-141" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(M1) <span class="ot">&lt;-</span> <span class="fu">colnames</span>(M)</span>
<span id="cb33-142"><a href="#cb33-142" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-143"><a href="#cb33-143" aria-hidden="true" tabindex="-1"></a><span class="co"># Rotate M 45-degrees.</span></span>
<span id="cb33-144"><a href="#cb33-144" aria-hidden="true" tabindex="-1"></a>B <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">c</span>(<span class="fu">sqrt</span>(<span class="dv">2</span>)<span class="sc">/</span><span class="dv">2</span>, <span class="fu">sqrt</span>(<span class="dv">2</span>)<span class="sc">/</span><span class="dv">2</span>, <span class="sc">-</span><span class="fu">sqrt</span>(<span class="dv">2</span>)<span class="sc">/</span><span class="dv">2</span>, <span class="fu">sqrt</span>(<span class="dv">2</span>)<span class="sc">/</span><span class="dv">2</span>), <span class="at">nrow =</span> <span class="dv">2</span>)</span>
<span id="cb33-145"><a href="#cb33-145" aria-hidden="true" tabindex="-1"></a>M2 <span class="ot">&lt;-</span> M <span class="sc">%*%</span> B</span>
<span id="cb33-146"><a href="#cb33-146" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(M2) <span class="ot">&lt;-</span> <span class="fu">colnames</span>(M)</span>
<span id="cb33-147"><a href="#cb33-147" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-148"><a href="#cb33-148" aria-hidden="true" tabindex="-1"></a><span class="fu">bind_rows</span>(</span>
<span id="cb33-149"><a href="#cb33-149" aria-hidden="true" tabindex="-1"></a>  <span class="st">`</span><span class="at">45 degree line</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">as_tibble</span>(M1),</span>
<span id="cb33-150"><a href="#cb33-150" aria-hidden="true" tabindex="-1"></a>  <span class="st">`</span><span class="at">Rotated 45 degrees</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">as_tibble</span>(M2),</span>
<span id="cb33-151"><a href="#cb33-151" aria-hidden="true" tabindex="-1"></a>  <span class="at">.id =</span> <span class="st">"series"</span></span>
<span id="cb33-152"><a href="#cb33-152" aria-hidden="true" tabindex="-1"></a>) <span class="sc">|&gt;</span></span>
<span id="cb33-153"><a href="#cb33-153" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> X, <span class="at">y =</span> Y, <span class="at">color =</span> series)) <span class="sc">+</span></span>
<span id="cb33-154"><a href="#cb33-154" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>() <span class="sc">+</span></span>
<span id="cb33-155"><a href="#cb33-155" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="cn">NULL</span>, <span class="at">y =</span> <span class="cn">NULL</span>, <span class="at">color =</span> <span class="cn">NULL</span>)</span>
<span id="cb33-156"><a href="#cb33-156" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb33-157"><a href="#cb33-157" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-158"><a href="#cb33-158" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb33-159"><a href="#cb33-159" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-160"><a href="#cb33-160" aria-hidden="true" tabindex="-1"></a>Extending this idea to the entire sample of three cameras, you might start by naively assuming the three cameras collect data from the _same perspective_, taking each measurement at face value. The set of orthonormal basis vectors, $\textbf{B}$ would look like this identity matrix</span>
<span id="cb33-161"><a href="#cb33-161" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-162"><a href="#cb33-162" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb33-163"><a href="#cb33-163" aria-hidden="true" tabindex="-1"></a>\textbf{B} = \begin{bmatrix} b_1 <span class="sc">\\</span> b_2 <span class="sc">\\</span> \vdots <span class="sc">\\</span> b_m \end{bmatrix} = \begin{bmatrix} 1 &amp; 0 &amp; \cdots &amp; 0 <span class="sc">\\</span> 0 &amp; 1 &amp; \cdots &amp; 0 <span class="sc">\\</span> \vdots &amp; \vdots &amp; \ddots &amp; \vdots <span class="sc">\\</span> 0 &amp; 0 &amp; \cdots &amp; 1 \end{bmatrix}</span>
<span id="cb33-164"><a href="#cb33-164" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb33-165"><a href="#cb33-165" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-166"><a href="#cb33-166" aria-hidden="true" tabindex="-1"></a>where $b_1$ and $b_2$ are the bases used by camera $A$, etc. Now the data set $\textbf{X}$ can be expressed as the matrix multiplication, $\textbf{BX}$. This added complexity allows you to ask whether another basis, $\textbf{P}$, _that is a linear combination of the original basis_, better expresses the data set, $\textbf{PX} = \textbf{Y}$. The _linear_ restriction is a key simplifying assumption of PCA. $\textbf{P}$ transforms $\textbf{X}$ into $\textbf{Y}$, but you can also think of it as rotating and stretching $\textbf{X}$ into $\textbf{Y}.$</span>
<span id="cb33-167"><a href="#cb33-167" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-168"><a href="#cb33-168" aria-hidden="true" tabindex="-1"></a>The goal of PCA is to maximize variance (the signal-to-noise ratio) and minimize covariance (redundancy). The signal-to-noise ratio is $SNR = \sigma^2_{signal} / \sigma^2_{noise}$. In each camera's 2D perspective, the signal is the amplitude of the movement of the spring along the x-axis and the noise is the movement along the y-axis. Looking at the raw (un-rotated) data from camera $A$, you might guess the spring dynamics occur in the direction yielding the highest SNR, the 45-degree rotation. </span>
<span id="cb33-169"><a href="#cb33-169" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-172"><a href="#cb33-172" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb33-173"><a href="#cb33-173" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb33-174"><a href="#cb33-174" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb33-175"><a href="#cb33-175" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-width: 3.5</span></span>
<span id="cb33-176"><a href="#cb33-176" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-height: 3.5</span></span>
<span id="cb33-177"><a href="#cb33-177" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-178"><a href="#cb33-178" aria-hidden="true" tabindex="-1"></a><span class="co"># In one camera's 2D space perspective, the spring along the x-axis with amplitude</span></span>
<span id="cb33-179"><a href="#cb33-179" aria-hidden="true" tabindex="-1"></a><span class="co"># [0, 100]. There is noise in signal which you can represent as perturbations in</span></span>
<span id="cb33-180"><a href="#cb33-180" aria-hidden="true" tabindex="-1"></a><span class="co"># the y-axis (normally distributed)</span></span>
<span id="cb33-181"><a href="#cb33-181" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">0</span><span class="sc">:</span><span class="dv">100</span>)</span>
<span id="cb33-182"><a href="#cb33-182" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">101</span>, <span class="dv">0</span>, <span class="dv">5</span>)</span>
<span id="cb33-183"><a href="#cb33-183" aria-hidden="true" tabindex="-1"></a>my_dat <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(x, y)</span>
<span id="cb33-184"><a href="#cb33-184" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-185"><a href="#cb33-185" aria-hidden="true" tabindex="-1"></a><span class="co"># rotate y 45 degrees</span></span>
<span id="cb33-186"><a href="#cb33-186" aria-hidden="true" tabindex="-1"></a>B <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">c</span>(<span class="fu">sqrt</span>(<span class="dv">2</span>)<span class="sc">/</span><span class="dv">2</span>, <span class="sc">-</span><span class="fu">sqrt</span>(<span class="dv">2</span>)<span class="sc">/</span><span class="dv">2</span>, <span class="fu">sqrt</span>(<span class="dv">2</span>)<span class="sc">/</span><span class="dv">2</span>, <span class="fu">sqrt</span>(<span class="dv">2</span>)<span class="sc">/</span><span class="dv">2</span>), <span class="at">nrow =</span> <span class="dv">2</span>)</span>
<span id="cb33-187"><a href="#cb33-187" aria-hidden="true" tabindex="-1"></a>my_dat <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">c</span>(x, y), <span class="at">ncol =</span> <span class="dv">2</span>) <span class="sc">%*%</span> B <span class="sc">%&gt;%</span> <span class="fu">data.frame</span>()</span>
<span id="cb33-188"><a href="#cb33-188" aria-hidden="true" tabindex="-1"></a>signal <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">c</span>(<span class="dv">50</span>, <span class="dv">100</span>, <span class="dv">0</span>, <span class="dv">0</span>), <span class="at">ncol =</span> <span class="dv">2</span>) <span class="sc">%*%</span> B <span class="sc">%&gt;%</span> <span class="fu">data.frame</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb33-189"><a href="#cb33-189" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">ID =</span> <span class="fu">row_number</span>()) <span class="sc">%&gt;%</span></span>
<span id="cb33-190"><a href="#cb33-190" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_wider</span>(<span class="at">names_from =</span> ID, <span class="at">values_from =</span> X1<span class="sc">:</span>X2)</span>
<span id="cb33-191"><a href="#cb33-191" aria-hidden="true" tabindex="-1"></a>noise <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">c</span>(<span class="dv">50</span>, <span class="dv">50</span>, <span class="dv">0</span>, <span class="dv">10</span>), <span class="at">ncol =</span> <span class="dv">2</span>) <span class="sc">%*%</span> B <span class="sc">%&gt;%</span> <span class="fu">data.frame</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb33-192"><a href="#cb33-192" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">ID =</span> <span class="fu">row_number</span>()) <span class="sc">%&gt;%</span></span>
<span id="cb33-193"><a href="#cb33-193" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_wider</span>(<span class="at">names_from =</span> ID, <span class="at">values_from =</span> X1<span class="sc">:</span>X2)</span>
<span id="cb33-194"><a href="#cb33-194" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-195"><a href="#cb33-195" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb33-196"><a href="#cb33-196" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">dat =</span> my_dat, <span class="fu">aes</span>(<span class="at">x =</span> X1, <span class="at">y =</span> X2)) <span class="sc">+</span></span>
<span id="cb33-197"><a href="#cb33-197" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_segment</span>(<span class="at">data =</span> signal, <span class="fu">aes</span>(<span class="at">x =</span> X1_1, <span class="at">xend =</span> X1_2, <span class="at">y =</span> X2_1, <span class="at">yend =</span> X2_2),</span>
<span id="cb33-198"><a href="#cb33-198" aria-hidden="true" tabindex="-1"></a>               <span class="at">color =</span> <span class="st">"goldenrod"</span>, <span class="at">linewidth =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb33-199"><a href="#cb33-199" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_segment</span>(<span class="at">data =</span> noise, <span class="fu">aes</span>(<span class="at">x =</span> X1_1, <span class="at">xend =</span> X1_2, <span class="at">y =</span> X2_1, <span class="at">yend =</span> X2_2),</span>
<span id="cb33-200"><a href="#cb33-200" aria-hidden="true" tabindex="-1"></a>               <span class="at">color =</span> <span class="st">"goldenrod"</span>, <span class="at">linewidth =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb33-201"><a href="#cb33-201" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="cn">NULL</span>, <span class="at">y =</span> <span class="cn">NULL</span>)</span>
<span id="cb33-202"><a href="#cb33-202" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb33-203"><a href="#cb33-203" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-204"><a href="#cb33-204" aria-hidden="true" tabindex="-1"></a>The other criteria is redundancy. There are three cameras recording the same activity, so they are perfectly correlated. If $\textbf{X}$ is an $m \times n$ matrix of centered values (subtracting the mean), PCA will find an orthonormal matrix $\textbf{P}$ in $\textbf{Y} = \textbf{PX}$ such that the covariance matrix $\textbf{C}_\textbf{Y} = \frac{1}{n}\textbf{YY}^T$ is a diagonal matrix. The rows of $\textbf{P}$ are the principal components of $\textbf{X}$.</span>
<span id="cb33-205"><a href="#cb33-205" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-206"><a href="#cb33-206" aria-hidden="true" tabindex="-1"></a>The process is to select a normalized direction in *m*-dimensional space which maximizes the $\textbf{X}$ variance. Save this vector as $\textbf{p}_1$. Next find a second direction along which variance is maximized, but restrict the search to directions that are orthogonal to the previous direction. Save this vector as $\textbf{p}_2$. Repeat until all *m* vectors are selected. The resulting ordered set of $\textbf{p}$'s are the principal components.</span>
<span id="cb33-207"><a href="#cb33-207" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-208"><a href="#cb33-208" aria-hidden="true" tabindex="-1"></a>With matrix algebra, you can express $\textbf{C}_\textbf{Y}$ in terms of the covariance matrix of $\textbf{X}$, $\textbf{C}_\textbf{X}$.</span>
<span id="cb33-209"><a href="#cb33-209" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-210"><a href="#cb33-210" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb33-211"><a href="#cb33-211" aria-hidden="true" tabindex="-1"></a>\begin{align}</span>
<span id="cb33-212"><a href="#cb33-212" aria-hidden="true" tabindex="-1"></a>\textbf{C}_\textbf{Y} &amp;= \frac{1}{n}\textbf{YY}^T <span class="sc">\\</span></span>
<span id="cb33-213"><a href="#cb33-213" aria-hidden="true" tabindex="-1"></a>&amp;= \frac{1}{n}(\textbf{PX})(\textbf{PX})^T <span class="sc">\\</span></span>
<span id="cb33-214"><a href="#cb33-214" aria-hidden="true" tabindex="-1"></a>&amp;= \frac{1}{n}\textbf{PXX}^T\textbf{P}^T <span class="sc">\\</span></span>
<span id="cb33-215"><a href="#cb33-215" aria-hidden="true" tabindex="-1"></a>&amp;= P\left(\frac{1}{n}\textbf{XX}^T\right)\textbf{P}^T <span class="sc">\\</span></span>
<span id="cb33-216"><a href="#cb33-216" aria-hidden="true" tabindex="-1"></a>&amp;= \textbf{PC}_\textbf{X}\textbf{P}^T</span>
<span id="cb33-217"><a href="#cb33-217" aria-hidden="true" tabindex="-1"></a>\end{align}</span>
<span id="cb33-218"><a href="#cb33-218" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb33-219"><a href="#cb33-219" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-220"><a href="#cb33-220" aria-hidden="true" tabindex="-1"></a>Any symmetric matrix can be diagonalized by an orthogonal matrix of its eigenvectors, $\textbf{C}_\textbf{X} = \textbf{E}^T\textbf{DE}$. So select $\textbf{P}$ to be such a matrix.</span>
<span id="cb33-221"><a href="#cb33-221" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-222"><a href="#cb33-222" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb33-223"><a href="#cb33-223" aria-hidden="true" tabindex="-1"></a>\begin{align}</span>
<span id="cb33-224"><a href="#cb33-224" aria-hidden="true" tabindex="-1"></a>\textbf{C}_\textbf{Y} &amp;= \textbf{PC}_\textbf{X}\textbf{P}^T <span class="sc">\\</span></span>
<span id="cb33-225"><a href="#cb33-225" aria-hidden="true" tabindex="-1"></a>&amp;= \textbf{P}(\textbf{E}^T\textbf{DE})\textbf{P}^T <span class="sc">\\</span></span>
<span id="cb33-226"><a href="#cb33-226" aria-hidden="true" tabindex="-1"></a>&amp;= \textbf{P}(\textbf{P}^T\textbf{DP})\textbf{P}^T <span class="sc">\\</span></span>
<span id="cb33-227"><a href="#cb33-227" aria-hidden="true" tabindex="-1"></a>&amp;= (\textbf{PP}^T)\textbf{D}(\textbf{PP}^T) <span class="sc">\\</span></span>
<span id="cb33-228"><a href="#cb33-228" aria-hidden="true" tabindex="-1"></a>&amp;= (\textbf{PP}^{-1})\textbf{D}(\textbf{PP}^{-1}) <span class="sc">\\</span></span>
<span id="cb33-229"><a href="#cb33-229" aria-hidden="true" tabindex="-1"></a>&amp;= \textbf{D}</span>
<span id="cb33-230"><a href="#cb33-230" aria-hidden="true" tabindex="-1"></a>\end{align}</span>
<span id="cb33-231"><a href="#cb33-231" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb33-232"><a href="#cb33-232" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-233"><a href="#cb33-233" aria-hidden="true" tabindex="-1"></a><span class="fu">## Case Study</span></span>
<span id="cb33-234"><a href="#cb33-234" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-235"><a href="#cb33-235" aria-hidden="true" tabindex="-1"></a>Let's work with a case study presented by <span class="co">[</span><span class="ot">Laerd</span><span class="co">](https://statistics.laerd.com/premium/spss/pca/pca-in-spss.php)</span>. </span>
<span id="cb33-236"><a href="#cb33-236" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-239"><a href="#cb33-239" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb33-240"><a href="#cb33-240" aria-hidden="true" tabindex="-1"></a><span class="co">#| include: false</span></span>
<span id="cb33-241"><a href="#cb33-241" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-242"><a href="#cb33-242" aria-hidden="true" tabindex="-1"></a>likert_scale <span class="ot">&lt;-</span> <span class="fu">c</span>(</span>
<span id="cb33-243"><a href="#cb33-243" aria-hidden="true" tabindex="-1"></a>  <span class="st">"Strongly Agree"</span>, <span class="st">"Agree"</span>, <span class="st">"Agree Somewhat"</span>, <span class="st">"Undecided"</span>, <span class="st">"Disagree Somewhat"</span>,</span>
<span id="cb33-244"><a href="#cb33-244" aria-hidden="true" tabindex="-1"></a>  <span class="st">"Disagree"</span>, <span class="st">"Strongly Disagree"</span></span>
<span id="cb33-245"><a href="#cb33-245" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb33-246"><a href="#cb33-246" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb33-247"><a href="#cb33-247" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-250"><a href="#cb33-250" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb33-251"><a href="#cb33-251" aria-hidden="true" tabindex="-1"></a>pca_dat <span class="ot">&lt;-</span> </span>
<span id="cb33-252"><a href="#cb33-252" aria-hidden="true" tabindex="-1"></a>  foreign<span class="sc">::</span><span class="fu">read.spss</span>(<span class="st">"./input/pca.sav"</span>, <span class="at">to.data.frame =</span> <span class="cn">TRUE</span>) <span class="sc">|&gt;</span></span>
<span id="cb33-253"><a href="#cb33-253" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb33-254"><a href="#cb33-254" aria-hidden="true" tabindex="-1"></a>    <span class="fu">across</span>(<span class="fu">where</span>(is.factor), <span class="sc">~</span><span class="fu">factor</span>(., <span class="at">levels =</span> likert_scale, <span class="at">ordered =</span> <span class="cn">TRUE</span>))</span>
<span id="cb33-255"><a href="#cb33-255" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb33-256"><a href="#cb33-256" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-257"><a href="#cb33-257" aria-hidden="true" tabindex="-1"></a><span class="fu">glimpse</span>(pca_dat)</span>
<span id="cb33-258"><a href="#cb33-258" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb33-259"><a href="#cb33-259" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-262"><a href="#cb33-262" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb33-263"><a href="#cb33-263" aria-hidden="true" tabindex="-1"></a><span class="co">#| include: false</span></span>
<span id="cb33-264"><a href="#cb33-264" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-265"><a href="#cb33-265" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="fu">nrow</span>(pca_dat)</span>
<span id="cb33-266"><a href="#cb33-266" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-267"><a href="#cb33-267" aria-hidden="true" tabindex="-1"></a>q_colnames <span class="ot">&lt;-</span> pca_dat <span class="sc">%&gt;%</span> <span class="fu">select</span>(Qu1<span class="sc">:</span>Qu25) <span class="sc">%&gt;%</span> <span class="fu">colnames</span>()</span>
<span id="cb33-268"><a href="#cb33-268" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb33-269"><a href="#cb33-269" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-270"><a href="#cb33-270" aria-hidden="true" tabindex="-1"></a><span class="in">`r n`</span> job candidates complete a questionnaire consisting of 25 questions using a 7-level Likert scale. Questions focused on motivation, dependability, enthusiasm, and commitment.</span>
<span id="cb33-271"><a href="#cb33-271" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-274"><a href="#cb33-274" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb33-275"><a href="#cb33-275" aria-hidden="true" tabindex="-1"></a><span class="co">#| include: false</span></span>
<span id="cb33-276"><a href="#cb33-276" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-277"><a href="#cb33-277" aria-hidden="true" tabindex="-1"></a>gt_items <span class="ot">&lt;-</span> <span class="cf">function</span>(items) {</span>
<span id="cb33-278"><a href="#cb33-278" aria-hidden="true" tabindex="-1"></a>  pca_dat <span class="sc">|&gt;</span></span>
<span id="cb33-279"><a href="#cb33-279" aria-hidden="true" tabindex="-1"></a>    <span class="fu">select</span>(<span class="fu">all_of</span>(items)) <span class="sc">|&gt;</span></span>
<span id="cb33-280"><a href="#cb33-280" aria-hidden="true" tabindex="-1"></a>    <span class="fu">pivot_longer</span>(<span class="fu">everything</span>()) <span class="sc">|&gt;</span></span>
<span id="cb33-281"><a href="#cb33-281" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">name =</span> <span class="fu">fct_drop</span>(<span class="fu">factor</span>(name, <span class="at">levels =</span> q_colnames))) <span class="sc">|&gt;</span></span>
<span id="cb33-282"><a href="#cb33-282" aria-hidden="true" tabindex="-1"></a>    gtsummary<span class="sc">::</span><span class="fu">tbl_summary</span>(<span class="at">by =</span> <span class="st">"value"</span>, <span class="at">percent =</span> <span class="st">"row"</span>, <span class="at">label =</span> <span class="fu">list</span>(name <span class="sc">~</span> <span class="st">""</span>)) <span class="sc">|&gt;</span></span>
<span id="cb33-283"><a href="#cb33-283" aria-hidden="true" tabindex="-1"></a>    gtsummary<span class="sc">::</span><span class="fu">as_gt</span>()</span>
<span id="cb33-284"><a href="#cb33-284" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb33-285"><a href="#cb33-285" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb33-286"><a href="#cb33-286" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-287"><a href="#cb33-287" aria-hidden="true" tabindex="-1"></a>::: panel-tabset</span>
<span id="cb33-288"><a href="#cb33-288" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-289"><a href="#cb33-289" aria-hidden="true" tabindex="-1"></a><span class="fu">### Motivaton</span></span>
<span id="cb33-290"><a href="#cb33-290" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-293"><a href="#cb33-293" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb33-294"><a href="#cb33-294" aria-hidden="true" tabindex="-1"></a><span class="fu">gt_items</span>(<span class="fu">c</span>(<span class="st">"Qu3"</span>, <span class="st">"Qu4"</span>, <span class="st">"Qu5"</span>, <span class="st">"Qu6"</span>, <span class="st">"Qu7"</span>, <span class="st">"Qu8"</span>, <span class="st">"Qu12"</span>, <span class="st">"Qu13"</span>))</span>
<span id="cb33-295"><a href="#cb33-295" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb33-296"><a href="#cb33-296" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-297"><a href="#cb33-297" aria-hidden="true" tabindex="-1"></a><span class="fu">### Dependability</span></span>
<span id="cb33-298"><a href="#cb33-298" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-301"><a href="#cb33-301" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb33-302"><a href="#cb33-302" aria-hidden="true" tabindex="-1"></a><span class="fu">gt_items</span>(<span class="fu">c</span>(<span class="st">"Qu2"</span>, <span class="st">"Qu14"</span>, <span class="st">"Qu15"</span>, <span class="st">"Qu16"</span>, <span class="st">"Qu17"</span>, <span class="st">"Qu18"</span>, <span class="st">"Qu19"</span>))</span>
<span id="cb33-303"><a href="#cb33-303" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb33-304"><a href="#cb33-304" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-305"><a href="#cb33-305" aria-hidden="true" tabindex="-1"></a><span class="fu">### Enthusiasm</span></span>
<span id="cb33-306"><a href="#cb33-306" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-309"><a href="#cb33-309" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb33-310"><a href="#cb33-310" aria-hidden="true" tabindex="-1"></a><span class="fu">gt_items</span>(<span class="fu">c</span>(<span class="st">"Qu20"</span>, <span class="st">"Qu21"</span>, <span class="st">"Qu22"</span>, <span class="st">"Qu23"</span>, <span class="st">"Qu24"</span>, <span class="st">"Qu25"</span>))</span>
<span id="cb33-311"><a href="#cb33-311" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb33-312"><a href="#cb33-312" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-313"><a href="#cb33-313" aria-hidden="true" tabindex="-1"></a><span class="fu">### Commitment</span></span>
<span id="cb33-314"><a href="#cb33-314" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-317"><a href="#cb33-317" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb33-318"><a href="#cb33-318" aria-hidden="true" tabindex="-1"></a><span class="fu">gt_items</span>(<span class="fu">c</span>(<span class="st">"Qu1"</span>, <span class="st">"Qu9"</span>, <span class="st">"Qu10"</span>, <span class="st">"Qu11"</span>))</span>
<span id="cb33-319"><a href="#cb33-319" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb33-320"><a href="#cb33-320" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-321"><a href="#cb33-321" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb33-322"><a href="#cb33-322" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-323"><a href="#cb33-323" aria-hidden="true" tabindex="-1"></a><span class="fu">## Assumptions</span></span>
<span id="cb33-324"><a href="#cb33-324" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-325"><a href="#cb33-325" aria-hidden="true" tabindex="-1"></a>Missing values can bias PCA results. If you have missing values, you should either impute, remove the observations, or drop the columns. Fortunately there are no missing values in this dataset.</span>
<span id="cb33-326"><a href="#cb33-326" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-329"><a href="#cb33-329" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb33-330"><a href="#cb33-330" aria-hidden="true" tabindex="-1"></a><span class="fu">colSums</span>(<span class="fu">is.na</span>(pca_dat))</span>
<span id="cb33-331"><a href="#cb33-331" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb33-332"><a href="#cb33-332" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-333"><a href="#cb33-333" aria-hidden="true" tabindex="-1"></a>Let's drop the unrelated <span class="in">`FAC*`</span> cols. PCA only works with numerical values. Our questionnaire uses a 7-level scale, so we're probably okay to treat that as numeric. The data should also be normalized (subtract mean, divide by SD). Note that the <span class="in">`scale()`</span> function returns the data as a matrix (fine).</span>
<span id="cb33-334"><a href="#cb33-334" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-337"><a href="#cb33-337" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb33-338"><a href="#cb33-338" aria-hidden="true" tabindex="-1"></a>pca_numeric <span class="ot">&lt;-</span></span>
<span id="cb33-339"><a href="#cb33-339" aria-hidden="true" tabindex="-1"></a>  pca_dat <span class="sc">|&gt;</span></span>
<span id="cb33-340"><a href="#cb33-340" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="fu">starts_with</span>(<span class="st">"Qu"</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb33-341"><a href="#cb33-341" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="fu">across</span>(<span class="fu">everything</span>(), as.numeric)) <span class="sc">|&gt;</span></span>
<span id="cb33-342"><a href="#cb33-342" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale</span>()</span>
<span id="cb33-343"><a href="#cb33-343" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-344"><a href="#cb33-344" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(pca_numeric)</span>
<span id="cb33-345"><a href="#cb33-345" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb33-346"><a href="#cb33-346" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-347"><a href="#cb33-347" aria-hidden="true" tabindex="-1"></a>PCA is based on correlation coefficients, so all variables should be linearly related (*r* &gt; .3) to at least one other variable. You might test this with a correlation matrix scatterplot, but the number of relationships can get unwieldy. </span>
<span id="cb33-348"><a href="#cb33-348" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-351"><a href="#cb33-351" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb33-352"><a href="#cb33-352" aria-hidden="true" tabindex="-1"></a>corr_mtrx <span class="ot">&lt;-</span> <span class="fu">cor</span>(pca_numeric, <span class="at">method =</span> <span class="st">"pearson"</span>)</span>
<span id="cb33-353"><a href="#cb33-353" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-354"><a href="#cb33-354" aria-hidden="true" tabindex="-1"></a>ggcorrplot<span class="sc">::</span><span class="fu">ggcorrplot</span>(corr_mtrx)</span>
<span id="cb33-355"><a href="#cb33-355" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb33-356"><a href="#cb33-356" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-357"><a href="#cb33-357" aria-hidden="true" tabindex="-1"></a>Instead, just query the matrix for the max correlations. The worst is q20.</span>
<span id="cb33-358"><a href="#cb33-358" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-361"><a href="#cb33-361" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb33-362"><a href="#cb33-362" aria-hidden="true" tabindex="-1"></a><span class="co"># Load necessary library</span></span>
<span id="cb33-363"><a href="#cb33-363" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb33-364"><a href="#cb33-364" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-365"><a href="#cb33-365" aria-hidden="true" tabindex="-1"></a><span class="co"># Set seed for reproducibility</span></span>
<span id="cb33-366"><a href="#cb33-366" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb33-367"><a href="#cb33-367" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-368"><a href="#cb33-368" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a toy dataset</span></span>
<span id="cb33-369"><a href="#cb33-369" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">100</span></span>
<span id="cb33-370"><a href="#cb33-370" aria-hidden="true" tabindex="-1"></a>var1 <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(n, <span class="at">mean =</span> <span class="dv">0</span>, <span class="at">sd =</span> <span class="dv">1</span>)</span>
<span id="cb33-371"><a href="#cb33-371" aria-hidden="true" tabindex="-1"></a>var2 <span class="ot">&lt;-</span> var1 <span class="sc">+</span> <span class="fu">rnorm</span>(n, <span class="at">mean =</span> <span class="dv">0</span>, <span class="at">sd =</span> <span class="fl">0.1</span>)  <span class="co"># Strongly correlated with var1</span></span>
<span id="cb33-372"><a href="#cb33-372" aria-hidden="true" tabindex="-1"></a>var3 <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(n, <span class="at">mean =</span> <span class="dv">0</span>, <span class="at">sd =</span> <span class="dv">1</span>)           <span class="co"># Weakly correlated with var1 and var2</span></span>
<span id="cb33-373"><a href="#cb33-373" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-374"><a href="#cb33-374" aria-hidden="true" tabindex="-1"></a>data <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(var1, var2, var3)</span>
<span id="cb33-375"><a href="#cb33-375" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-376"><a href="#cb33-376" aria-hidden="true" tabindex="-1"></a><span class="co"># Standardize the dataset</span></span>
<span id="cb33-377"><a href="#cb33-377" aria-hidden="true" tabindex="-1"></a>data_scaled <span class="ot">&lt;-</span> <span class="fu">scale</span>(data)</span>
<span id="cb33-378"><a href="#cb33-378" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-379"><a href="#cb33-379" aria-hidden="true" tabindex="-1"></a><span class="co"># Perform PCA</span></span>
<span id="cb33-380"><a href="#cb33-380" aria-hidden="true" tabindex="-1"></a>pca <span class="ot">&lt;-</span> <span class="fu">prcomp</span>(data_scaled, <span class="at">center =</span> <span class="cn">TRUE</span>, <span class="at">scale. =</span> <span class="cn">TRUE</span>)</span>
<span id="cb33-381"><a href="#cb33-381" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-382"><a href="#cb33-382" aria-hidden="true" tabindex="-1"></a><span class="co"># Summary of PCA</span></span>
<span id="cb33-383"><a href="#cb33-383" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(pca)</span>
<span id="cb33-384"><a href="#cb33-384" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-385"><a href="#cb33-385" aria-hidden="true" tabindex="-1"></a><span class="co"># Biplot of PCA</span></span>
<span id="cb33-386"><a href="#cb33-386" aria-hidden="true" tabindex="-1"></a><span class="fu">biplot</span>(pca)</span>
<span id="cb33-387"><a href="#cb33-387" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-388"><a href="#cb33-388" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb33-389"><a href="#cb33-389" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-390"><a href="#cb33-390" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-393"><a href="#cb33-393" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb33-394"><a href="#cb33-394" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb33-395"><a href="#cb33-395" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-396"><a href="#cb33-396" aria-hidden="true" tabindex="-1"></a><span class="fu">as_tibble</span>(corr_mtrx) <span class="sc">|&gt;</span></span>
<span id="cb33-397"><a href="#cb33-397" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">var1 =</span> <span class="fu">factor</span>(q_colnames, <span class="at">levels =</span> q_colnames)) <span class="sc">|&gt;</span></span>
<span id="cb33-398"><a href="#cb33-398" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> <span class="fu">c</span>(Qu1<span class="sc">:</span>Qu25), <span class="at">names_to =</span> <span class="st">"var2"</span>, <span class="at">values_to =</span> <span class="st">"rho"</span>) <span class="sc">|&gt;</span></span>
<span id="cb33-399"><a href="#cb33-399" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(var1 <span class="sc">!=</span> var2) <span class="sc">|&gt;</span></span>
<span id="cb33-400"><a href="#cb33-400" aria-hidden="true" tabindex="-1"></a>  <span class="fu">slice_max</span>(<span class="at">by =</span> var1, <span class="at">order_by =</span> rho, <span class="at">n =</span> <span class="dv">1</span>) <span class="sc">|&gt;</span></span>
<span id="cb33-401"><a href="#cb33-401" aria-hidden="true" tabindex="-1"></a>  gt<span class="sc">::</span><span class="fu">gt</span>() <span class="sc">|&gt;</span> </span>
<span id="cb33-402"><a href="#cb33-402" aria-hidden="true" tabindex="-1"></a>  gt<span class="sc">::</span><span class="fu">data_color</span>(</span>
<span id="cb33-403"><a href="#cb33-403" aria-hidden="true" tabindex="-1"></a>    <span class="at">columns =</span> rho, </span>
<span id="cb33-404"><a href="#cb33-404" aria-hidden="true" tabindex="-1"></a>    <span class="at">method =</span> <span class="st">"numeric"</span>,</span>
<span id="cb33-405"><a href="#cb33-405" aria-hidden="true" tabindex="-1"></a>    <span class="at">palette =</span> <span class="fu">c</span>(<span class="st">"white"</span>, <span class="st">"dodgerblue3"</span>),</span>
<span id="cb33-406"><a href="#cb33-406" aria-hidden="true" tabindex="-1"></a>    <span class="at">domain =</span> <span class="fu">c</span>(<span class="fl">0.2</span>, .<span class="dv">9</span>)</span>
<span id="cb33-407"><a href="#cb33-407" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb33-408"><a href="#cb33-408" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb33-409"><a href="#cb33-409" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-410"><a href="#cb33-410" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>The sample sizes should be large. As a rule of thumb, there should be at least 5 cases per variable.</span>
<span id="cb33-411"><a href="#cb33-411" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>There should be no outliers. Component scores greater than 3 standard deviations away from the mean can have a disproportionate influence on the results.</span>
<span id="cb33-412"><a href="#cb33-412" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-413"><a href="#cb33-413" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Sampling Adequacy {-}</span></span>
<span id="cb33-414"><a href="#cb33-414" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-415"><a href="#cb33-415" aria-hidden="true" tabindex="-1"></a>Each variable and the complete model should have an "adequate sample". The Kaiser-Meyer-Olkin (KMO) measure of sampling adequacy compares the variable's correlations with other variables to the partial correlations in the data. The test measures sampling adequacy for each variable in the model and for the complete model.^<span class="co">[</span><span class="ot">See [Statistics How-to](https://www.statisticshowto.com/kaiser-meyer-olkin/).</span><span class="co">]</span> </span>
<span id="cb33-416"><a href="#cb33-416" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-417"><a href="#cb33-417" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb33-418"><a href="#cb33-418" aria-hidden="true" tabindex="-1"></a>\text{KMO}_j = \frac{\sum_{i \ne j}r_{ij}^2}{\sum_{i \ne j}r_{ij}^2 + \sum_{i \ne j} u}</span>
<span id="cb33-419"><a href="#cb33-419" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb33-420"><a href="#cb33-420" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-421"><a href="#cb33-421" aria-hidden="true" tabindex="-1"></a>where $r_{ij}$ are correlations, and $u_{ij}$ are partial covariances.</span>
<span id="cb33-422"><a href="#cb33-422" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-425"><a href="#cb33-425" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb33-426"><a href="#cb33-426" aria-hidden="true" tabindex="-1"></a>EFAtools<span class="sc">::</span><span class="fu">KMO</span>(corr_mtrx)</span>
<span id="cb33-427"><a href="#cb33-427" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb33-428"><a href="#cb33-428" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-429"><a href="#cb33-429" aria-hidden="true" tabindex="-1"></a>Scores range from 0 to 1. Values should be at least .6 to justify a PCA. Values over .8 are preferable.</span>
<span id="cb33-430"><a href="#cb33-430" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-431"><a href="#cb33-431" aria-hidden="true" tabindex="-1"></a>Bartlett's test of sphericity tests the null hypothesis that the correlation matrix is an identity matrix, i.e., there are no correlations between any variables.</span>
<span id="cb33-432"><a href="#cb33-432" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-435"><a href="#cb33-435" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb33-436"><a href="#cb33-436" aria-hidden="true" tabindex="-1"></a>EFAtools<span class="sc">::</span><span class="fu">BARTLETT</span>(corr_mtrx, <span class="at">N =</span> <span class="fu">nrow</span>(pca_dat))</span>
<span id="cb33-437"><a href="#cb33-437" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb33-438"><a href="#cb33-438" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-439"><a href="#cb33-439" aria-hidden="true" tabindex="-1"></a><span class="fu">## Perform PCA</span></span>
<span id="cb33-440"><a href="#cb33-440" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-441"><a href="#cb33-441" aria-hidden="true" tabindex="-1"></a><span class="in">`princomp()`</span> from the stats package performs a PCA analysis. </span>
<span id="cb33-442"><a href="#cb33-442" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-445"><a href="#cb33-445" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb33-446"><a href="#cb33-446" aria-hidden="true" tabindex="-1"></a><span class="fu">princomp</span>(pca_numeric,</span>
<span id="cb33-447"><a href="#cb33-447" aria-hidden="true" tabindex="-1"></a>  <span class="at">cor =</span> <span class="cn">TRUE</span></span>
<span id="cb33-448"><a href="#cb33-448" aria-hidden="true" tabindex="-1"></a>) <span class="sc">%&gt;%</span> <span class="fu">summary</span>()</span>
<span id="cb33-449"><a href="#cb33-449" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-450"><a href="#cb33-450" aria-hidden="true" tabindex="-1"></a>pca_result <span class="ot">&lt;-</span> <span class="fu">prcomp</span>(pca_numeric, <span class="at">center =</span> <span class="cn">TRUE</span>, <span class="at">scale =</span> <span class="cn">TRUE</span>) </span>
<span id="cb33-451"><a href="#cb33-451" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-452"><a href="#cb33-452" aria-hidden="true" tabindex="-1"></a>pca_result<span class="sc">$</span>rotation</span>
<span id="cb33-453"><a href="#cb33-453" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-454"><a href="#cb33-454" aria-hidden="true" tabindex="-1"></a><span class="fu">biplot</span>(pca_result, <span class="at">scale =</span> <span class="dv">0</span>)</span>
<span id="cb33-455"><a href="#cb33-455" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-456"><a href="#cb33-456" aria-hidden="true" tabindex="-1"></a>pca_result<span class="sc">$</span>sdev<span class="sc">^</span><span class="dv">2</span> <span class="sc">/</span> <span class="fu">sum</span>(pca_result<span class="sc">$</span>sdev<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb33-457"><a href="#cb33-457" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb33-458"><a href="#cb33-458" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-459"><a href="#cb33-459" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-460"><a href="#cb33-460" aria-hidden="true" tabindex="-1"></a>The communality is the proportion of each variable's variance that is accounted for by the principal components analysis and can also be expressed as a percentage. </span>
<span id="cb33-461"><a href="#cb33-461" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-462"><a href="#cb33-462" aria-hidden="true" tabindex="-1"></a>A principal components analysis will produce as many components as there are variables. However, the purpose of principal components analysis is to explain as much of the variance in your variables as possible using as few components as possible. After you have extracted your components, there are four major criteria that can help you decide on the number of components to retain: (a) the eigenvalue-one criterion, (b) the proportion of total variance accounted for, (c) the scree plot test, and (d) the interpretability criterion. All except for the first criterion will require some degree of subjective analysis. </span>
<span id="cb33-463"><a href="#cb33-463" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-464"><a href="#cb33-464" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-465"><a href="#cb33-465" aria-hidden="true" tabindex="-1"></a><span class="fu">## Appendix: Eigenvectors</span></span>
<span id="cb33-466"><a href="#cb33-466" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-467"><a href="#cb33-467" aria-hidden="true" tabindex="-1"></a>A square matrix, $\textbf{A}$, can be decomposed into eigenvalues, $\lambda$, and eigenvectors, $\textbf{v}$.^<span class="co">[</span><span class="ot">Took these notes from [Math is Fun](https://www.mathsisfun.com/algebra/eigenvalue.html).</span><span class="co">]</span></span>
<span id="cb33-468"><a href="#cb33-468" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-469"><a href="#cb33-469" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb33-470"><a href="#cb33-470" aria-hidden="true" tabindex="-1"></a>\textbf{A} \textbf{v} = \lambda \textbf{v}</span>
<span id="cb33-471"><a href="#cb33-471" aria-hidden="true" tabindex="-1"></a>$$ {#eq-eigen1}</span>
<span id="cb33-472"><a href="#cb33-472" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-473"><a href="#cb33-473" aria-hidden="true" tabindex="-1"></a>For example, $6$ and $\begin{bmatrix}1 <span class="sc">\\</span> 4 \end{bmatrix}$ are an eigenvalue and eigenvector here:</span>
<span id="cb33-474"><a href="#cb33-474" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-475"><a href="#cb33-475" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb33-476"><a href="#cb33-476" aria-hidden="true" tabindex="-1"></a>\begin{bmatrix} -6 &amp; 3 <span class="sc">\\</span> 4 &amp; 5 \end{bmatrix} \begin{bmatrix}1 <span class="sc">\\</span> 4 \end{bmatrix} = 6 \begin{bmatrix}1 <span class="sc">\\</span> 4 \end{bmatrix}</span>
<span id="cb33-477"><a href="#cb33-477" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb33-478"><a href="#cb33-478" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-479"><a href="#cb33-479" aria-hidden="true" tabindex="-1"></a>@eq-eigen1 can be re-expressed as $\textbf{A} \textbf{v} - \lambda \textbf{I} \textbf{v} = 0.$ For $\textbf{v}$ to be non-zero, the determinant must be zero, </span>
<span id="cb33-480"><a href="#cb33-480" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-481"><a href="#cb33-481" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb33-482"><a href="#cb33-482" aria-hidden="true" tabindex="-1"></a>| \textbf{A} - \lambda \textbf{I}| = 0</span>
<span id="cb33-483"><a href="#cb33-483" aria-hidden="true" tabindex="-1"></a>$$ {#eq-eigen2}</span>
<span id="cb33-484"><a href="#cb33-484" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-485"><a href="#cb33-485" aria-hidden="true" tabindex="-1"></a>Back to the example, use @eq-eigen2 to find possible eigenvalues.</span>
<span id="cb33-486"><a href="#cb33-486" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-487"><a href="#cb33-487" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb33-488"><a href="#cb33-488" aria-hidden="true" tabindex="-1"></a>\left| \begin{bmatrix} -6 &amp; 3 <span class="sc">\\</span> 4 &amp; 5 \end{bmatrix} - \lambda \begin{bmatrix} 1 &amp; 0 <span class="sc">\\</span> 0 &amp; 1 \end{bmatrix} \right| = 0</span>
<span id="cb33-489"><a href="#cb33-489" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb33-490"><a href="#cb33-490" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-491"><a href="#cb33-491" aria-hidden="true" tabindex="-1"></a>Subtract the matrices and calculate the determinant, $(-6 - \lambda)(5 - \lambda) - 3 \times 4 = 0,$ then solve for $\lambda = -7 \text{ or } 6.$ Now that you have the possible eigenvalues, plug them back into Equation \@ref(eq:eigen1). For $\lambda = 6$ you have</span>
<span id="cb33-492"><a href="#cb33-492" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-493"><a href="#cb33-493" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb33-494"><a href="#cb33-494" aria-hidden="true" tabindex="-1"></a>\begin{bmatrix} -6 &amp; 3 <span class="sc">\\</span> 4 &amp; 5 \end{bmatrix} \begin{bmatrix}x <span class="sc">\\</span> y \end{bmatrix} = 6 \begin{bmatrix}x <span class="sc">\\</span> y \end{bmatrix}</span>
<span id="cb33-495"><a href="#cb33-495" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb33-496"><a href="#cb33-496" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-497"><a href="#cb33-497" aria-hidden="true" tabindex="-1"></a>Solving the system of equations reveals that $y = 4x$. So $\begin{bmatrix}1 <span class="sc">\\</span> 4 \end{bmatrix}$ is a solution. You can do the same exercise for $\lambda = -7$.</span>
<span id="cb33-498"><a href="#cb33-498" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-499"><a href="#cb33-499" aria-hidden="true" tabindex="-1"></a>Eigenvectors and eigenvalues are useful because matrices are used to make transformations in space. In transformations, the eigenvector is the axis of rotation, the direction that does not change, and the eigenvalue is the scale of the stretch (1 = no change, 2 = double length, -1 = point backwards, etc.).</span>
</code><button title="Copy to Clipboard" class="code-copy-button" data-in-quarto-modal=""><i class="bi"></i></button></pre></div>
</div></div></div></div></div>
</div> <!-- /content -->




</body></html>